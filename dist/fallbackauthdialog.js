!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=829)}({1:function(e,t,r){"use strict";(function(e){r.d(t,"d",(function(){return o})),r.d(t,"a",(function(){return i})),r.d(t,"f",(function(){return a})),r.d(t,"c",(function(){return c})),r.d(t,"b",(function(){return s})),r.d(t,"e",(function(){return u})),r.d(t,"g",(function(){return l}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function o(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function a(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function c(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a}function s(t,r,n,o){return new(n||(n=e))((function(e,i){function a(e){try{s(o.next(e))}catch(e){i(e)}}function c(e){try{s(o.throw(e))}catch(e){i(e)}}function s(t){t.done?e(t.value):new n((function(e){e(t.value)})).then(a,c)}s((o=o.apply(t,r||[])).next())}))}function u(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}}function l(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,c=i.length;a<c;a++,o++)n[o]=i[a];return n}}).call(this,r(93).Promise)},109:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(33),o=r(22),i=function(){function e(e,t,r,n,o,i,a){this.accountIdentifier=e,this.homeAccountIdentifier=t,this.userName=r,this.name=n,this.idToken=o,this.idTokenClaims=o,this.sid=i,this.environment=a}return e.createAccount=function(t,r){var i,a=t.objectId||t.subject,c=r?r.uid:"",s=r?r.utid:"";return o.a.isEmpty(c)||o.a.isEmpty(s)||(i=n.a.base64Encode(c)+"."+n.a.base64Encode(s)),new e(a,i,t.preferredName,t.name,t.claims,t.sid,t.issuer)},e.compareAccounts=function(e,t){return!(!e||!t)&&!(!e.homeAccountIdentifier||!t.homeAccountIdentifier||e.homeAccountIdentifier!==t.homeAccountIdentifier)},e}()},110:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r(1),o=r(2),i=function(e,t){this.key=e,this.value=t},a=r(27),c=r(70),s=function(){function e(e){if(!window)throw c.a.createNoWindowObjectError("Browser storage class could not find window object");if(!(void 0!==window[e]&&null!=window[e]))throw a.a.createStorageNotSupportedError(e);this.cacheLocation=e}return e.prototype.setItem=function(e,t,r){window[this.cacheLocation].setItem(e,t),r&&this.setItemCookie(e,t)},e.prototype.getItem=function(e,t){return t&&this.getItemCookie(e)?this.getItemCookie(e):window[this.cacheLocation].getItem(e)},e.prototype.removeItem=function(e){return window[this.cacheLocation].removeItem(e)},e.prototype.clear=function(){return window[this.cacheLocation].clear()},e.prototype.setItemCookie=function(e,t,r){var n=e+"="+t+";path=/;";r&&(n+="expires="+this.getCookieExpirationTime(r)+";");document.cookie=n},e.prototype.getItemCookie=function(e){for(var t=e+"=",r=document.cookie.split(";"),n=0;n<r.length;n++){for(var o=r[n];" "===o.charAt(0);)o=o.substring(1);if(0===o.indexOf(t))return o.substring(t.length,o.length)}return""},e.prototype.clearItemCookie=function(e){this.setItemCookie(e,"",-1)},e.prototype.getCookieExpirationTime=function(e){var t=new Date;return new Date(t.getTime()+24*e*60*60*1e3).toUTCString()},e}(),u=r(16),l=function(e){function t(t,r,n){var o=e.call(this,r)||this;return o.clientId=t,o.rollbackEnabled=!0,o.migrateCacheEntries(n),o}return n.d(t,e),t.prototype.migrateCacheEntries=function(t){var r=this,n=o.c.cachePrefix+"."+o.f.IDTOKEN,i=o.c.cachePrefix+"."+o.f.CLIENT_INFO,a=o.c.cachePrefix+"."+o.d.ERROR,c=o.c.cachePrefix+"."+o.d.ERROR_DESC,s=[e.prototype.getItem.call(this,n),e.prototype.getItem.call(this,i),e.prototype.getItem.call(this,a),e.prototype.getItem.call(this,c)];[o.f.IDTOKEN,o.f.CLIENT_INFO,o.d.ERROR,o.d.ERROR_DESC].forEach((function(e,n){return r.duplicateCacheEntry(e,s[n],t)}))},t.prototype.duplicateCacheEntry=function(e,t,r){t&&this.setItem(e,t,r)},t.prototype.generateCacheKey=function(e,t){try{return JSON.parse(e),e}catch(r){return 0===e.indexOf(""+o.c.cachePrefix)||0===e.indexOf(o.c.adalIdToken)?e:t?o.c.cachePrefix+"."+this.clientId+"."+e:o.c.cachePrefix+"."+e}},t.prototype.setItem=function(t,r,n,o){e.prototype.setItem.call(this,this.generateCacheKey(t,!0),r,n),this.rollbackEnabled&&e.prototype.setItem.call(this,this.generateCacheKey(t,!1),r,n)},t.prototype.getItem=function(t,r){return e.prototype.getItem.call(this,this.generateCacheKey(t,!0),r)},t.prototype.removeItem=function(t){e.prototype.removeItem.call(this,this.generateCacheKey(t,!0)),this.rollbackEnabled&&e.prototype.removeItem.call(this,this.generateCacheKey(t,!1))},t.prototype.resetCacheItems=function(){var t,r=window[this.cacheLocation];for(t in r)r.hasOwnProperty(t)&&-1!==t.indexOf(o.c.cachePrefix)&&e.prototype.removeItem.call(this,t)},t.prototype.resetTempCacheItems=function(e){var t,r=window[this.cacheLocation];for(t in r)e&&-1===t.indexOf(e)||this.tokenRenewalInProgress(e)||(this.removeItem(t),this.setItemCookie(t,"",-1),this.clearMsalCookie(e));this.removeItem(o.j.INTERACTION_STATUS),this.removeItem(o.j.REDIRECT_REQUEST)},t.prototype.setItemCookie=function(t,r,n){e.prototype.setItemCookie.call(this,this.generateCacheKey(t,!0),r,n),this.rollbackEnabled&&e.prototype.setItemCookie.call(this,this.generateCacheKey(t,!1),r,n)},t.prototype.getItemCookie=function(t){return e.prototype.getItemCookie.call(this,this.generateCacheKey(t,!0))},t.prototype.getAllAccessTokens=function(e,t){var r=this;return Object.keys(window[this.cacheLocation]).reduce((function(n,a){if(a.match(e)&&a.match(t)&&a.match(o.c.scopes)){var c=r.getItem(a);if(c)try{var s=JSON.parse(a),l=new i(s,JSON.parse(c));return n.concat([l])}catch(e){throw u.a.createCacheParseError(a)}}return n}),[])},t.prototype.tokenRenewalInProgress=function(e){var t=this.getItem(o.j.RENEW_STATUS+"|"+e);return!(!t||t!==o.c.inProgress)},t.prototype.clearMsalCookie=function(e){this.clearItemCookie(o.j.NONCE_IDTOKEN+"|"+e),this.clearItemCookie(o.j.STATE_LOGIN+"|"+e),this.clearItemCookie(o.j.LOGIN_REQUEST+"|"+e),this.clearItemCookie(o.j.STATE_ACQ_TOKEN+"|"+e)},t.generateAcquireTokenAccountKey=function(e,t){return""+o.j.ACQUIRE_TOKEN_ACCOUNT+o.c.resourceDelimiter+e+o.c.resourceDelimiter+t},t.generateAuthorityKey=function(e){return""+o.j.AUTHORITY+o.c.resourceDelimiter+e},t}(s)},12:function(e,t,r){"use strict";r.d(t,"d",(function(){return c})),r.d(t,"b",(function(){return s})),r.d(t,"c",(function(){return u})),r.d(t,"a",(function(){return d})),r.d(t,"e",(function(){return h}));var n=r(2),o=r(49),i=r(33),a=r(19),c=function(e){var t=a.a.GetUrlComponents(e);if(!n.a[t.HostNameAndPort.toLocaleLowerCase()])return e;var r=t.PathSegments;if(r&&r.length>=2){var i="tfp"===r[1]?2:1;i<r.length&&(r[i]=o.f)}return t.Protocol+"//"+t.HostNameAndPort+"/"+r.join("/")},s=function(e){return i.a.base64Encode(e)},u=function(e){return""+o.c+(e||"")},l=function(){return!!("undefined"!=typeof window&&"performance"in window&&window.performance.mark&&window.performance.measure)},d=function(e,t,r){l()&&(window.performance.mark(r),window.performance.measure(e,t,r),window.performance.clearMeasures(e),window.performance.clearMarks(t),window.performance.clearMarks(r))},h=function(e){l()&&window.performance.mark(e)}},137:function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var n=r(1),o=r(2),i=r(27),a=r(98),c=r(22),s=r(33),u=r(188),l=r(16),d=function(){function e(){}return e.validateRequest=function(e,t,r,o){if(!t&&!e)throw i.a.createEmptyRequestError();var c,s;e&&(c=t?a.a.appendScopes(e.scopes,e.extraScopesToConsent):e.scopes,a.a.validateInputScope(c,!t,r),this.validatePromptParameter(e.prompt),s=this.validateEQParameters(e.extraQueryParameters,e.claimsRequest),this.validateClaimsRequest(e.claimsRequest));var u=this.validateAndGenerateState(e&&e.state,o),l=this.validateAndGenerateCorrelationId(e&&e.correlationId);return n.a({},e,{extraQueryParameters:s,scopes:c,state:u,correlationId:l})},e.validatePromptParameter=function(e){if(e&&[o.g.LOGIN,o.g.SELECT_ACCOUNT,o.g.CONSENT,o.g.NONE].indexOf(e)<0)throw i.a.createInvalidPromptError(e)},e.validateEQParameters=function(e,t){var r=n.a({},e);return r?(t&&delete r[o.c.claims],o.b.forEach((function(e){r[e]&&delete r[e]})),r):null},e.validateClaimsRequest=function(e){if(e)try{JSON.parse(e)}catch(e){throw i.a.createClaimsRequestParsingError(e)}},e.validateAndGenerateState=function(t,r){return c.a.isEmpty(t)?e.generateLibraryState(r):""+e.generateLibraryState(r)+o.c.resourceDelimiter+t},e.generateLibraryState=function(e){var t={id:s.a.createNewGuid(),ts:u.a.now(),method:e},r=JSON.stringify(t);return s.a.base64Encode(r)},e.parseLibraryState=function(e){var t=decodeURIComponent(e).split(o.c.resourceDelimiter)[0];if(s.a.isGuid(t))return{id:t,ts:u.a.now(),method:o.c.interactionTypeRedirect};try{var r=s.a.base64Decode(t);return JSON.parse(r)}catch(t){throw l.a.createInvalidStateError(e,null)}},e.validateAndGenerateCorrelationId=function(e){if(e&&!s.a.isGuid(e))throw i.a.createInvalidCorrelationIdError();return s.a.isGuid(e)?e:s.a.createNewGuid()},e.createRequestSignature=function(e){return""+e.scopes.join(" ").toLowerCase()+o.c.resourceDelimiter+e.authority},e}()},144:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r(33),o=r(2),i=r(22),a=r(98),c=function(){function e(e,t,r,i,c,s,u){this.authorityInstance=e,this.clientId=t,this.nonce=n.a.createNewGuid(),this.scopes=c?c.slice():[t],this.scopes=a.a.trimAndConvertArrayToLowerCase(this.scopes),this.state=s,this.correlationId=u,this.xClientSku="MSAL.JS",this.xClientVer=Object(o.k)(),this.responseType=r,this.redirectUri=i}return Object.defineProperty(e.prototype,"authority",{get:function(){return this.authorityInstance?this.authorityInstance.CanonicalAuthority:null},enumerable:!0,configurable:!0}),e.prototype.populateQueryParams=function(t,r,n,o){var i={};r&&(r.prompt&&(this.promptValue=r.prompt),r.claimsRequest&&(this.claimsValue=r.claimsRequest),e.isSSOParam(r)&&(i=this.constructUnifiedCacheQueryParameter(r,null))),n&&(i=this.constructUnifiedCacheQueryParameter(null,n)),i=this.addHintParameters(t,i);var a=r?r.extraQueryParameters:null;this.queryParameters=e.generateQueryParametersString(i),this.extraQueryParameters=e.generateQueryParametersString(a,o)},e.prototype.constructUnifiedCacheQueryParameter=function(e,t){var r,n;if(e)if(e.account){var i=e.account;i.sid?(r=o.h.SID,n=i.sid):i.userName&&(r=o.h.LOGIN_HINT,n=i.userName)}else e.sid?(r=o.h.SID,n=e.sid):e.loginHint&&(r=o.h.LOGIN_HINT,n=e.loginHint);else t&&t.hasOwnProperty(o.c.upn)&&(r=o.h.ID_TOKEN,n=t.upn);return this.addSSOParameter(r,n)},e.prototype.addHintParameters=function(e,t){e&&!t[o.h.SID]&&(!t[o.h.LOGIN_HINT]&&e.sid&&this.promptValue===o.g.NONE?t=this.addSSOParameter(o.h.SID,e.sid,t):!t[o.h.LOGIN_HINT]&&e.userName&&!i.a.isEmpty(e.userName)&&(t=this.addSSOParameter(o.h.LOGIN_HINT,e.userName,t)));return t},e.prototype.addSSOParameter=function(e,t,r){if(r||(r={}),!t)return r;switch(e){case o.h.SID:r[o.h.SID]=t;break;case o.h.ID_TOKEN:case o.h.LOGIN_HINT:r[o.h.LOGIN_HINT]=t}return r},e.generateQueryParametersString=function(e,t){var r=null;return e&&Object.keys(e).forEach((function(n){n===o.c.domain_hint&&(t||e[o.h.SID])||(null==r?r=n+"="+encodeURIComponent(e[n]):r+="&"+n+"="+encodeURIComponent(e[n]))})),r},e.isSSOParam=function(e){return e&&(e.account||e.sid||e.loginHint)},e}()},157:function(e,t){var r,n,o=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function c(e){if(r===setTimeout)return setTimeout(e,0);if((r===i||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:i}catch(e){r=i}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(e){n=a}}();var s,u=[],l=!1,d=-1;function h(){l&&s&&(l=!1,s.length?u=s.concat(u):d=-1,u.length&&p())}function p(){if(!l){var e=c(h);l=!0;for(var t=u.length;t;){for(s=u,u=[];++d<t;)s&&s[d].run();d=-1,t=u.length}s=null,l=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function g(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];u.push(new f(e,t)),1!==u.length||l||c(p)},f.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=g,o.addListener=g,o.once=g,o.off=g,o.removeListener=g,o.removeAllListeners=g,o.emit=g,o.prependListener=g,o.prependOnceListener=g,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},16:function(e,t,r){"use strict";r.d(t,"b",(function(){return a})),r.d(t,"a",(function(){return c}));var n=r(1),o=r(70),i=r(22),a={multipleMatchingTokens:{code:"multiple_matching_tokens",desc:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements like authority."},multipleCacheAuthorities:{code:"multiple_authorities",desc:"Multiple authorities found in the cache. Pass authority in the API overload."},endpointResolutionError:{code:"endpoints_resolution_error",desc:"Error: could not resolve endpoints. Please check network and try again."},popUpWindowError:{code:"popup_window_error",desc:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."},tokenRenewalError:{code:"token_renewal_error",desc:"Token renewal operation failed due to timeout."},invalidIdToken:{code:"invalid_id_token",desc:"Invalid ID token format."},invalidStateError:{code:"invalid_state_error",desc:"Invalid state."},nonceMismatchError:{code:"nonce_mismatch_error",desc:"Nonce is not matching, Nonce received: "},loginProgressError:{code:"login_progress_error",desc:"Login_In_Progress: Error during login call - login is already in progress."},acquireTokenProgressError:{code:"acquiretoken_progress_error",desc:"AcquireToken_In_Progress: Error during login call - login is already in progress."},userCancelledError:{code:"user_cancelled",desc:"User cancelled the flow."},callbackError:{code:"callback_error",desc:"Error occurred in token received callback function."},userLoginRequiredError:{code:"user_login_error",desc:"User login is required. For silent calls, request must contain either sid or login_hint"},userDoesNotExistError:{code:"user_non_existent",desc:"User object does not exist. Please call a login API."},clientInfoDecodingError:{code:"client_info_decoding_error",desc:"The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause."},clientInfoNotPopulatedError:{code:"client_info_not_populated_error",desc:"The service did not populate client_info in the response, Please verify with the service team"},nullOrEmptyIdToken:{code:"null_or_empty_id_token",desc:"The idToken is null or empty. Please review the trace to determine the root cause."},idTokenNotParsed:{code:"id_token_parsing_error",desc:"ID token cannot be parsed. Please review stack trace to determine root cause."},tokenEncodingError:{code:"token_encoding_error",desc:"The token to be decoded is not encoded correctly."},invalidInteractionType:{code:"invalid_interaction_type",desc:"The interaction type passed to the handler was incorrect or unknown"},cacheParseError:{code:"cannot_parse_cache",desc:"The cached token key is not a valid JSON and cannot be parsed"},blockTokenRequestsInHiddenIframe:{code:"block_token_requests",desc:"Token calls are blocked in hidden iframes"}},c=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="ClientAuthError",Object.setPrototypeOf(o,t.prototype),o}return n.d(t,e),t.createEndpointResolutionError=function(e){var r=a.endpointResolutionError.desc;return e&&!i.a.isEmpty(e)&&(r+=" Details: "+e),new t(a.endpointResolutionError.code,r)},t.createMultipleMatchingTokensInCacheError=function(e){return new t(a.multipleMatchingTokens.code,"Cache error for scope "+e+": "+a.multipleMatchingTokens.desc+".")},t.createMultipleAuthoritiesInCacheError=function(e){return new t(a.multipleCacheAuthorities.code,"Cache error for scope "+e+": "+a.multipleCacheAuthorities.desc+".")},t.createPopupWindowError=function(e){var r=a.popUpWindowError.desc;return e&&!i.a.isEmpty(e)&&(r+=" Details: "+e),new t(a.popUpWindowError.code,r)},t.createTokenRenewalTimeoutError=function(){return new t(a.tokenRenewalError.code,a.tokenRenewalError.desc)},t.createInvalidIdTokenError=function(e){return new t(a.invalidIdToken.code,a.invalidIdToken.desc+" Given token: "+e)},t.createInvalidStateError=function(e,r){return new t(a.invalidStateError.code,a.invalidStateError.desc+" "+e+", state expected : "+r+".")},t.createNonceMismatchError=function(e,r){return new t(a.nonceMismatchError.code,a.nonceMismatchError.desc+" "+e+", nonce expected : "+r+".")},t.createLoginInProgressError=function(){return new t(a.loginProgressError.code,a.loginProgressError.desc)},t.createAcquireTokenInProgressError=function(){return new t(a.acquireTokenProgressError.code,a.acquireTokenProgressError.desc)},t.createUserCancelledError=function(){return new t(a.userCancelledError.code,a.userCancelledError.desc)},t.createErrorInCallbackFunction=function(e){return new t(a.callbackError.code,a.callbackError.desc+" "+e+".")},t.createUserLoginRequiredError=function(){return new t(a.userLoginRequiredError.code,a.userLoginRequiredError.desc)},t.createUserDoesNotExistError=function(){return new t(a.userDoesNotExistError.code,a.userDoesNotExistError.desc)},t.createClientInfoDecodingError=function(e){return new t(a.clientInfoDecodingError.code,a.clientInfoDecodingError.desc+" Failed with error: "+e)},t.createClientInfoNotPopulatedError=function(e){return new t(a.clientInfoNotPopulatedError.code,a.clientInfoNotPopulatedError.desc+" Failed with error: "+e)},t.createIdTokenNullOrEmptyError=function(e){return new t(a.nullOrEmptyIdToken.code,a.nullOrEmptyIdToken.desc+" Raw ID Token Value: "+e)},t.createIdTokenParsingError=function(e){return new t(a.idTokenNotParsed.code,a.idTokenNotParsed.desc+" Failed with error: "+e)},t.createTokenEncodingError=function(e){return new t(a.tokenEncodingError.code,a.tokenEncodingError.desc+" Attempted to decode: "+e)},t.createInvalidInteractionTypeError=function(){return new t(a.invalidInteractionType.code,a.invalidInteractionType.desc)},t.createCacheParseError=function(e){var r="invalid key: "+e+", "+a.cacheParseError.desc;return new t(a.cacheParseError.code,r)},t.createBlockTokenRequestsInHiddenIframeError=function(){return new t(a.blockTokenRequestsInHiddenIframe.code,a.blockTokenRequestsInHiddenIframe.desc)},t}(o.a)},170:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n,o,i,a=r(1),c=r(186),s=r(49),u=r(12),l=Object(u.c)("authority"),d=Object(u.c)("authority_type"),h=Object(u.c)("ui_behavior"),p=Object(u.c)("tenant_id"),f=Object(u.c)("user_id"),g=Object(u.c)("was_successful"),m=Object(u.c)("api_error_code"),y=Object(u.c)("login_hint");!function(e){e[e.AcquireTokenRedirect=2001]="AcquireTokenRedirect",e[e.AcquireTokenSilent=2002]="AcquireTokenSilent",e[e.AcquireTokenPopup=2003]="AcquireTokenPopup",e[e.LoginRedirect=2004]="LoginRedirect",e[e.LoginPopup=2005]="LoginPopup",e[e.Logout=2006]="Logout"}(o||(o={})),function(e){e.AcquireTokenRedirect="AcquireTokenRedirect",e.AcquireTokenSilent="AcquireTokenSilent",e.AcquireTokenPopup="AcquireTokenPopup",e.LoginRedirect="LoginRedirect",e.LoginPopup="LoginPopup",e.Logout="Logout"}(i||(i={}));var v=((n={})[i.AcquireTokenSilent]=o.AcquireTokenSilent,n[i.AcquireTokenPopup]=o.AcquireTokenPopup,n[i.AcquireTokenRedirect]=o.AcquireTokenRedirect,n[i.LoginPopup]=o.LoginPopup,n[i.LoginRedirect]=o.LoginRedirect,n[i.Logout]=o.Logout,n),I=function(e){function t(t,r,n){var o=e.call(this,Object(u.c)("api_event"),t,n)||this;return n&&(o.apiCode=v[n],o.apiEventIdentifier=n),o.piiEnabled=r,o}return a.d(t,e),Object.defineProperty(t.prototype,"apiEventIdentifier",{set:function(e){this.event[s.e.ApiTelemIdConstStrKey]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"apiCode",{set:function(e){this.event[s.e.ApiIdConstStrKey]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authority",{set:function(e){this.event[l]=Object(u.d)(e).toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"apiErrorCode",{set:function(e){this.event[m]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tenantId",{set:function(e){this.event[p]=this.piiEnabled&&e?Object(u.b)(e):null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"accountId",{set:function(e){this.event[f]=this.piiEnabled&&e?Object(u.b)(e):null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"wasSuccessful",{get:function(){return!0===this.event[g]},set:function(e){this.event[g]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"loginHint",{set:function(e){this.event[y]=this.piiEnabled&&e?Object(u.b)(e):null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authorityType",{set:function(e){this.event[d]=e.toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"promptType",{set:function(e){this.event[h]=e.toLowerCase()},enumerable:!0,configurable:!0}),t}(c.a);t.b=I},171:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(16),o=r(245),i=r(22),a=function(e){if(i.a.isEmpty(e))throw n.a.createIdTokenNullOrEmptyError(e);try{this.rawIdToken=e,this.claims=o.a.extractIdToken(e),this.claims&&(this.claims.hasOwnProperty("iss")&&(this.issuer=this.claims.iss),this.claims.hasOwnProperty("oid")&&(this.objectId=this.claims.oid),this.claims.hasOwnProperty("sub")&&(this.subject=this.claims.sub),this.claims.hasOwnProperty("tid")&&(this.tenantId=this.claims.tid),this.claims.hasOwnProperty("ver")&&(this.version=this.claims.ver),this.claims.hasOwnProperty("preferred_username")&&(this.preferredName=this.claims.preferred_username),this.claims.hasOwnProperty("name")&&(this.name=this.claims.name),this.claims.hasOwnProperty("nonce")&&(this.nonce=this.claims.nonce),this.claims.hasOwnProperty("exp")&&(this.expiration=this.claims.exp),this.claims.hasOwnProperty("home_oid")&&(this.homeObjectId=this.claims.home_oid),this.claims.hasOwnProperty("sid")&&(this.sid=this.claims.sid),this.claims.hasOwnProperty("cloud_instance_host_name")&&(this.cloudInstance=this.claims.cloud_instance_host_name))}catch(e){throw n.a.createIdTokenParsingError(e)}}},184:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a}));var n,o=r(22),i=r(2);!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose"}(n||(n={}));var a=function(){function e(e,t){void 0===t&&(t={}),this.level=n.Info;var r=t.correlationId,o=void 0===r?"":r,i=t.level,a=void 0===i?n.Info:i,c=t.piiLoggingEnabled,s=void 0!==c&&c;this.localCallback=e,this.correlationId=o,this.level=a,this.piiLoggingEnabled=s}return e.prototype.logMessage=function(e,t,r){if(!(e>this.level||!this.piiLoggingEnabled&&r)){var a,c=(new Date).toUTCString();a=o.a.isEmpty(this.correlationId)?c+":"+Object(i.k)()+"-"+n[e]+(r?"-pii":"")+" "+t:c+":"+this.correlationId+"-"+Object(i.k)()+"-"+n[e]+(r?"-pii":"")+" "+t,this.executeCallback(e,a,r)}},e.prototype.executeCallback=function(e,t,r){this.localCallback&&this.localCallback(e,t,r)},e.prototype.error=function(e){this.logMessage(n.Error,e,!1)},e.prototype.errorPii=function(e){this.logMessage(n.Error,e,!0)},e.prototype.warning=function(e){this.logMessage(n.Warning,e,!1)},e.prototype.warningPii=function(e){this.logMessage(n.Warning,e,!0)},e.prototype.info=function(e){this.logMessage(n.Info,e,!1)},e.prototype.infoPii=function(e){this.logMessage(n.Info,e,!0)},e.prototype.verbose=function(e){this.logMessage(n.Verbose,e,!1)},e.prototype.verbosePii=function(e){this.logMessage(n.Verbose,e,!0)},e.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled},e}()},185:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r(1),o=r(70),i={code:"server_unavailable",desc:"Server is temporarily unavailable."},a={code:"unknown_server_error"},c=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="ServerError",Object.setPrototypeOf(o,t.prototype),o}return n.d(t,e),t.createServerUnavailableError=function(){return new t(i.code,i.desc)},t.createUnknownServerError=function(e){return new t(a.code,e)},t}(o.a)},186:function(e,t,r){"use strict";var n=r(1),o=r(49),i=r(12),a=r(33),c=function(){function e(e,t,r){var n;this.eventId=a.a.createNewGuid(),this.label=r,this.event=((n={})[Object(i.c)(o.b)]=e,n[Object(i.c)(o.a)]=-1,n[""+o.e.MsalCorrelationIdConstStrKey]=t,n)}return e.prototype.setElapsedTime=function(e){this.event[Object(i.c)(o.a)]=e},e.prototype.stop=function(){this.setElapsedTime(+Date.now()-+this.startTimestamp),Object(i.a)(this.displayName,this.perfStartMark,this.perfEndMark)},e.prototype.start=function(){this.startTimestamp=Date.now(),this.event[Object(i.c)(o.d)]=this.startTimestamp,Object(i.e)(this.perfStartMark)},Object.defineProperty(e.prototype,"telemetryCorrelationId",{get:function(){return this.event[""+o.e.MsalCorrelationIdConstStrKey]},set:function(e){this.event[""+o.e.MsalCorrelationIdConstStrKey]=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"eventName",{get:function(){return this.event[Object(i.c)(o.b)]},enumerable:!0,configurable:!0}),e.prototype.get=function(){return n.a({},this.event,{eventId:this.eventId})},Object.defineProperty(e.prototype,"key",{get:function(){return this.telemetryCorrelationId+"_"+this.eventId+"-"+this.eventName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"displayName",{get:function(){return"Msal-"+this.label+"-"+this.telemetryCorrelationId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"perfStartMark",{get:function(){return"start-"+this.key},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"perfEndMark",{get:function(){return"end-"+this.key},enumerable:!0,configurable:!0}),e}();t.a=c},187:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r(1),o=r(185),i={code:"interaction_required"},a={code:"consent_required"},c={code:"login_required"},s=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="InteractionRequiredAuthError",Object.setPrototypeOf(o,t.prototype),o}return n.d(t,e),t.isInteractionRequiredError=function(e){var t=[i.code,a.code,c.code];return e&&t.indexOf(e)>-1},t.createLoginRequiredAuthError=function(e){return new t(c.code,e)},t.createInteractionRequiredAuthError=function(e){return new t(i.code,e)},t.createConsentRequiredAuthError=function(e){return new t(a.code,e)},t}(o.a)},188:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(){function e(){}return e.parseExpiresIn=function(e){return e||(e="3599"),parseInt(e,10)},e.now=function(){return Math.round((new Date).getTime()/1e3)},e}()},189:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(33),o=r(16),i=r(22),a=function(){function e(e){if(!e||i.a.isEmpty(e))return this.uid="",void(this.utid="");try{var t=n.a.base64Decode(e),r=JSON.parse(t);r&&(r.hasOwnProperty("uid")&&(this.uid=r.uid),r.hasOwnProperty("utid")&&(this.utid=r.utid))}catch(e){throw o.a.createClientInfoDecodingError(e)}}return Object.defineProperty(e.prototype,"uid",{get:function(){return this._uid?this._uid:""},set:function(e){this._uid=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"utid",{get:function(){return this._utid?this._utid:""},set:function(e){this._utid=e},enumerable:!0,configurable:!0}),e}()},19:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r(2),o=r(98),i=r(22),a=r(33),c=function(){function e(){}return e.createNavigateUrl=function(e){var t=this.createNavigationUrlString(e),r=e.authorityInstance.AuthorizationEndpoint;return r.indexOf("?")<0?r+="?":r+="&",""+r+t.join("&")},e.createNavigationUrlString=function(e){var t=e.scopes;-1===t.indexOf(e.clientId)&&t.push(e.clientId);var r=[];return r.push("response_type="+e.responseType),this.translateclientIdUsedInScope(t,e.clientId),r.push("scope="+encodeURIComponent(o.a.parseScope(t))),r.push("client_id="+encodeURIComponent(e.clientId)),r.push("redirect_uri="+encodeURIComponent(e.redirectUri)),r.push("state="+encodeURIComponent(e.state)),r.push("nonce="+encodeURIComponent(e.nonce)),r.push("client_info=1"),r.push("x-client-SKU="+e.xClientSku),r.push("x-client-Ver="+e.xClientVer),e.promptValue&&r.push("prompt="+encodeURIComponent(e.promptValue)),e.claimsValue&&r.push("claims="+encodeURIComponent(e.claimsValue)),e.queryParameters&&r.push(e.queryParameters),e.extraQueryParameters&&r.push(e.extraQueryParameters),r.push("client-request-id="+encodeURIComponent(e.correlationId)),r},e.translateclientIdUsedInScope=function(e,t){var r=e.indexOf(t);r>=0&&(e.splice(r,1),-1===e.indexOf("openid")&&e.push("openid"),-1===e.indexOf("profile")&&e.push("profile"))},e.getCurrentUrl=function(){return window.location.href.split("?")[0].split("#")[0]},e.removeHashFromUrl=function(e){return e.split("#")[0]},e.replaceTenantPath=function(e,t){e=e.toLowerCase();var r=this.GetUrlComponents(e),o=r.PathSegments;return t&&0!==o.length&&o[0]===n.c.common&&(o[0]=t),this.constructAuthorityUriFromObject(r,o)},e.constructAuthorityUriFromObject=function(e,t){return this.CanonicalizeUri(e.Protocol+"//"+e.HostNameAndPort+"/"+t.join("/"))},e.GetUrlComponents=function(e){if(!e)throw"Url required";var t=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),r=e.match(t);if(!r||r.length<6)throw"Valid url required";var n={Protocol:r[1],HostNameAndPort:r[4],AbsolutePath:r[5]},o=n.AbsolutePath.split("/");return o=o.filter((function(e){return e&&e.length>0})),n.PathSegments=o,r[6]&&(n.Search=r[6]),r[8]&&(n.Hash=r[8]),n},e.CanonicalizeUri=function(t){return t&&(t=t.toLowerCase()),t&&!e.endsWith(t,"/")&&(t+="/"),t},e.endsWith=function(e,t){return!(!e||!t)&&-1!==e.indexOf(t,e.length-t.length)},e.urlRemoveQueryStringParameter=function(e,t){if(i.a.isEmpty(e))return e;var r=new RegExp("(\\&"+t+"=)[^&]+");return e=e.replace(r,""),r=new RegExp("("+t+"=)[^&]+&"),e=e.replace(r,""),r=new RegExp("("+t+"=)[^&]+"),e=e.replace(r,"")},e.getHashFromUrl=function(e){var t=e.indexOf("#"),r=e.indexOf("#/");return r>-1?e.substring(r+2):t>-1?e.substring(t+1):e},e.urlContainsHash=function(t){var r=e.deserializeHash(t);return r.hasOwnProperty(n.i.ERROR_DESCRIPTION)||r.hasOwnProperty(n.i.ERROR)||r.hasOwnProperty(n.i.ACCESS_TOKEN)||r.hasOwnProperty(n.i.ID_TOKEN)},e.deserializeHash=function(t){var r=e.getHashFromUrl(t);return a.a.deserialize(r)},e.getHostFromUri=function(e){var t=String(e).replace(/^(https?:)\/\//,"");return t=t.split("/")[0]},e}()},2:function(e,t,r){"use strict";r.d(t,"c",(function(){return c})),r.d(t,"i",(function(){return n})),r.d(t,"j",(function(){return o})),r.d(t,"f",(function(){return i})),r.d(t,"d",(function(){return a})),r.d(t,"a",(function(){return u})),r.d(t,"h",(function(){return s})),r.d(t,"b",(function(){return l})),r.d(t,"g",(function(){return d})),r.d(t,"e",(function(){return h})),r.d(t,"k",(function(){return p}));var n,o,i,a,c=function(){function e(){}return Object.defineProperty(e,"libraryName",{get:function(){return"Msal.js"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"claims",{get:function(){return"claims"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"clientId",{get:function(){return"clientId"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"adalIdToken",{get:function(){return"adal.idtoken"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"cachePrefix",{get:function(){return"msal"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"scopes",{get:function(){return"scopes"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"no_account",{get:function(){return"NO_ACCOUNT"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"upn",{get:function(){return"upn"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"domain_hint",{get:function(){return"domain_hint"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"prompt_select_account",{get:function(){return"&prompt=select_account"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"prompt_none",{get:function(){return"&prompt=none"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"prompt",{get:function(){return"prompt"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"response_mode_fragment",{get:function(){return"&response_mode=fragment"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"resourceDelimiter",{get:function(){return"|"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"cacheDelimiter",{get:function(){return"."},enumerable:!0,configurable:!0}),Object.defineProperty(e,"popUpWidth",{get:function(){return this._popUpWidth},set:function(e){this._popUpWidth=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"popUpHeight",{get:function(){return this._popUpHeight},set:function(e){this._popUpHeight=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"login",{get:function(){return"LOGIN"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"renewToken",{get:function(){return"RENEW_TOKEN"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"unknown",{get:function(){return"UNKNOWN"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"homeAccountIdentifier",{get:function(){return"homeAccountIdentifier"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"common",{get:function(){return"common"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"openidScope",{get:function(){return"openid"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"profileScope",{get:function(){return"profile"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"interactionTypeRedirect",{get:function(){return"redirectInteraction"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"interactionTypePopup",{get:function(){return"popupInteraction"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"interactionTypeSilent",{get:function(){return"silentInteraction"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"inProgress",{get:function(){return"inProgress"},enumerable:!0,configurable:!0}),e._popUpWidth=483,e._popUpHeight=600,e}();!function(e){e.SCOPE="scope",e.STATE="state",e.ERROR="error",e.ERROR_DESCRIPTION="error_description",e.ACCESS_TOKEN="access_token",e.ID_TOKEN="id_token",e.EXPIRES_IN="expires_in",e.SESSION_STATE="session_state",e.CLIENT_INFO="client_info"}(n||(n={})),function(e){e.AUTHORITY="authority",e.ACQUIRE_TOKEN_ACCOUNT="acquireTokenAccount",e.SESSION_STATE="session.state",e.STATE_LOGIN="state.login",e.STATE_ACQ_TOKEN="state.acquireToken",e.STATE_RENEW="state.renew",e.NONCE_IDTOKEN="nonce.idtoken",e.LOGIN_REQUEST="login.request",e.RENEW_STATUS="token.renew.status",e.URL_HASH="urlHash",e.INTERACTION_STATUS="interaction_status",e.REDIRECT_REQUEST="redirect_request"}(o||(o={})),function(e){e.IDTOKEN="idtoken",e.CLIENT_INFO="client.info"}(i||(i={})),function(e){e.LOGIN_ERROR="login.error",e.ERROR="error",e.ERROR_DESC="error.description"}(a||(a={}));var s,u={"login.windows.net":"login.windows.net","login.chinacloudapi.cn":"login.chinacloudapi.cn","login.cloudgovapi.us":"login.cloudgovapi.us","login.microsoftonline.com":"login.microsoftonline.com","login.microsoftonline.de":"login.microsoftonline.de","login.microsoftonline.us":"login.microsoftonline.us"};!function(e){e.ACCOUNT="account",e.SID="sid",e.LOGIN_HINT="login_hint",e.ID_TOKEN="id_token",e.ACCOUNT_ID="accountIdentifier",e.HOMEACCOUNT_ID="homeAccountIdentifier"}(s||(s={}));var l=[s.SID,s.LOGIN_HINT],d={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none"},h={ID_TOKEN_FRAME:"msalIdTokenFrame",TOKEN_FRAME:"msalRenewFrame"};function p(){return"1.3.2"}},22:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(){function e(){}return e.isEmpty=function(e){return void 0===e||!e||0===e.length},e}()},245:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(33),o=r(22),i=function(){function e(){}return e.decodeJwt=function(e){if(o.a.isEmpty(e))return null;var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);return!t||t.length<4?null:{header:t[1],JWSPayload:t[2],JWSSig:t[3]}},e.extractIdToken=function(e){var t=this.decodeJwt(e);if(!t)return null;try{var r=t.JWSPayload,o=n.a.base64Decode(r);return o?JSON.parse(o):null}catch(e){}return null},e}()},246:function(e,t,r){"use strict";function n(e){return{uniqueId:"",tenantId:"",tokenType:"",idToken:null,idTokenClaims:null,accessToken:"",scopes:null,expiresOn:null,account:null,accountState:e,fromCache:!1}}r.d(t,"a",(function(){return n}))},27:function(e,t,r){"use strict";r.d(t,"b",(function(){return i})),r.d(t,"a",(function(){return a}));var n=r(1),o=r(16),i={configurationNotSet:{code:"no_config_set",desc:"Configuration has not been set. Please call the UserAgentApplication constructor with a valid Configuration object."},storageNotSupported:{code:"storage_not_supported",desc:"The value for the cacheLocation is not supported."},noRedirectCallbacksSet:{code:"no_redirect_callbacks",desc:"No redirect callbacks have been set. Please call handleRedirectCallback() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},invalidCallbackObject:{code:"invalid_callback_object",desc:"The object passed for the callback was invalid. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},scopesRequired:{code:"scopes_required",desc:"Scopes are required to obtain an access token."},emptyScopes:{code:"empty_input_scopes_error",desc:"Scopes cannot be passed as empty array."},nonArrayScopes:{code:"nonarray_input_scopes_error",desc:"Scopes cannot be passed as non-array."},clientScope:{code:"clientid_input_scopes_error",desc:"Client ID can only be provided as a single scope."},invalidPrompt:{code:"invalid_prompt_value",desc:"Supported prompt values are 'login', 'select_account', 'consent' and 'none'"},invalidAuthorityType:{code:"invalid_authority_type",desc:"The given authority is not a valid type of authority supported by MSAL. Please see here for valid authorities: <insert URL here>."},authorityUriInsecure:{code:"authority_uri_insecure",desc:"Authority URIs must use https."},authorityUriInvalidPath:{code:"authority_uri_invalid_path",desc:"Given authority URI is invalid."},unsupportedAuthorityValidation:{code:"unsupported_authority_validation",desc:"The authority validation is not supported for this authority type."},untrustedAuthority:{code:"untrusted_authority",desc:"The provided authority is not a trusted authority. If using B2C, please include this authority in the knownAuthorities config parameter."},b2cAuthorityUriInvalidPath:{code:"b2c_authority_uri_invalid_path",desc:"The given URI for the B2C authority is invalid."},b2cKnownAuthoritiesNotSet:{code:"b2c_known_authorities_not_set",desc:"Must set known authorities when validateAuthority is set to True and using B2C"},claimsRequestParsingError:{code:"claims_request_parsing_error",desc:"Could not parse the given claims request object."},emptyRequestError:{code:"empty_request_error",desc:"Request object is required."},invalidCorrelationIdError:{code:"invalid_guid_sent_as_correlationId",desc:"Please set the correlationId as a valid guid"},telemetryConfigError:{code:"telemetry_config_error",desc:"Telemetry config is not configured with required values"},ssoSilentError:{code:"sso_silent_error",desc:"request must contain either sid or login_hint"},invalidAuthorityMetadataError:{code:"authority_metadata_error",desc:"Invalid authorityMetadata. Must be a JSON object containing authorization_endpoint, end_session_endpoint, and issuer fields."}},a=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="ClientConfigurationError",Object.setPrototypeOf(o,t.prototype),o}return n.d(t,e),t.createNoSetConfigurationError=function(){return new t(i.configurationNotSet.code,""+i.configurationNotSet.desc)},t.createStorageNotSupportedError=function(e){return new t(i.storageNotSupported.code,i.storageNotSupported.desc+" Given location: "+e)},t.createRedirectCallbacksNotSetError=function(){return new t(i.noRedirectCallbacksSet.code,i.noRedirectCallbacksSet.desc)},t.createInvalidCallbackObjectError=function(e){return new t(i.invalidCallbackObject.code,i.invalidCallbackObject.desc+" Given value for callback function: "+e)},t.createEmptyScopesArrayError=function(e){return new t(i.emptyScopes.code,i.emptyScopes.desc+" Given value: "+e+".")},t.createScopesNonArrayError=function(e){return new t(i.nonArrayScopes.code,i.nonArrayScopes.desc+" Given value: "+e+".")},t.createClientIdSingleScopeError=function(e){return new t(i.clientScope.code,i.clientScope.desc+" Given value: "+e+".")},t.createScopesRequiredError=function(e){return new t(i.scopesRequired.code,i.scopesRequired.desc+" Given value: "+e)},t.createInvalidPromptError=function(e){return new t(i.invalidPrompt.code,i.invalidPrompt.desc+" Given value: "+e)},t.createClaimsRequestParsingError=function(e){return new t(i.claimsRequestParsingError.code,i.claimsRequestParsingError.desc+" Given value: "+e)},t.createEmptyRequestError=function(){var e=i.emptyRequestError;return new t(e.code,e.desc)},t.createInvalidCorrelationIdError=function(){return new t(i.invalidCorrelationIdError.code,i.invalidCorrelationIdError.desc)},t.createKnownAuthoritiesNotSetError=function(){return new t(i.b2cKnownAuthoritiesNotSet.code,i.b2cKnownAuthoritiesNotSet.desc)},t.createInvalidAuthorityTypeError=function(){return new t(i.invalidAuthorityType.code,i.invalidAuthorityType.desc)},t.createUntrustedAuthorityError=function(){return new t(i.untrustedAuthority.code,i.untrustedAuthority.desc)},t.createTelemetryConfigError=function(e){var r=i.telemetryConfigError,n=r.code,o=r.desc,a={applicationName:"string",applicationVersion:"string",telemetryEmitter:"function"};return new t(n,o+" mising values: "+Object.keys(a).reduce((function(t,r){return e[r]?t:t.concat([r+" ("+a[r]+")"])}),[]).join(","))},t.createSsoSilentError=function(){return new t(i.ssoSilentError.code,i.ssoSilentError.desc)},t.createInvalidAuthorityMetadataError=function(){return new t(i.invalidAuthorityMetadataError.code,i.invalidAuthorityMetadataError.desc)},t}(o.a)},282:function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return n}));var n=function(){function t(){}return t.prototype.sendRequestAsync=function(t,r,n){var o=this;return new e((function(e,n){var i=new XMLHttpRequest;if(i.open(r,t,!0),i.onload=function(t){var r;(i.status<200||i.status>=300)&&n(o.handleError(i.responseText));try{r=JSON.parse(i.responseText)}catch(e){n(o.handleError(i.responseText))}var a={statusCode:i.status,body:r};e(a)},i.onerror=function(e){n(i.status)},"GET"!==r)throw"not implemented";i.send()}))},t.prototype.handleError=function(e){var t;try{if((t=JSON.parse(e)).error)return t.error;throw e}catch(t){return e}},t}()}).call(this,r(93).Promise)},283:function(e,t,r){"use strict";var n=r(1),o=r(186),i=r(12),a=r(144),c=Object(i.c)("http_path"),s=Object(i.c)("user_agent"),u=Object(i.c)("query_parameters"),l=Object(i.c)("api_version"),d=Object(i.c)("response_code"),h=Object(i.c)("oauth_error_code"),p=Object(i.c)("http_method"),f=Object(i.c)("request_id_header"),g=Object(i.c)("spe_info"),m=Object(i.c)("server_error_code"),y=Object(i.c)("server_sub_error_code"),v=Object(i.c)("url"),I=function(e){function t(t,r){return e.call(this,Object(i.c)("http_event"),t,r)||this}return n.d(t,e),Object.defineProperty(t.prototype,"url",{set:function(e){var t=Object(i.d)(e);this.event[v]=t&&t.toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"httpPath",{set:function(e){this.event[c]=Object(i.d)(e).toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userAgent",{set:function(e){this.event[s]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"queryParams",{set:function(e){this.event[u]=a.a.generateQueryParametersString(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"apiVersion",{set:function(e){this.event[l]=e.toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"httpResponseStatus",{set:function(e){this.event[d]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"oAuthErrorCode",{set:function(e){this.event[h]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"httpMethod",{set:function(e){this.event[p]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"requestIdHeader",{set:function(e){this.event[f]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"speInfo",{set:function(e){this.event[g]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"serverErrorCode",{set:function(e){this.event[m]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"serverSubErrorCode",{set:function(e){this.event[y]=e},enumerable:!0,configurable:!0}),t}(o.a);t.a=I},284:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(1),o=function(){function e(){}return e.setResponseIdToken=function(e,t){if(!e)return null;if(!t)return e;var r=Number(t.expiration);return r&&!e.expiresOn&&(e.expiresOn=new Date(1e3*r)),n.a({},e,{idToken:t,idTokenClaims:t.claims,uniqueId:t.objectId||t.subject,tenantId:t.tenantId})},e}()},33:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(){function e(){}return e.createNewGuid=function(){var t=window.crypto;if(t&&t.getRandomValues){var r=new Uint8Array(16);return t.getRandomValues(r),r[6]|=64,r[6]&=79,r[8]|=128,r[8]&=191,e.decimalToHex(r[0])+e.decimalToHex(r[1])+e.decimalToHex(r[2])+e.decimalToHex(r[3])+"-"+e.decimalToHex(r[4])+e.decimalToHex(r[5])+"-"+e.decimalToHex(r[6])+e.decimalToHex(r[7])+"-"+e.decimalToHex(r[8])+e.decimalToHex(r[9])+"-"+e.decimalToHex(r[10])+e.decimalToHex(r[11])+e.decimalToHex(r[12])+e.decimalToHex(r[13])+e.decimalToHex(r[14])+e.decimalToHex(r[15])}for(var n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",o="0123456789abcdef",i=0,a="",c=0;c<36;c++)"-"!==n[c]&&"4"!==n[c]&&(i=16*Math.random()|0),"x"===n[c]?a+=o[i]:"y"===n[c]?(i&=3,a+=o[i|=8]):a+=n[c];return a},e.isGuid=function(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)},e.decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},e.base64Encode=function(e){return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,(function(e,t){return String.fromCharCode(Number("0x"+t))})))},e.base64Decode=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Invalid base64 string")}return decodeURIComponent(atob(t).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""))},e.deserialize=function(e){var t,r=/\+/g,n=/([^&=]+)=([^&]*)/g,o=function(e){return decodeURIComponent(decodeURIComponent(e.replace(r," ")))},i={};for(t=n.exec(e);t;)i[o(t[1])]=o(t[2]),t=n.exec(e);return i},e}()},354:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(33),o=r(19),i=function(e,t,r,i,a){this.authority=o.a.CanonicalizeUri(e),this.clientId=t,this.scopes=r,this.homeAccountIdentifier=n.a.base64Encode(i)+"."+n.a.base64Encode(a)}},355:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(e,t,r,n){this.accessToken=e,this.idToken=t,this.expiresIn=r,this.homeAccountIdentifier=n}},356:function(e,t,r){"use strict";var n=r(1),o=r(49),i=r(186),a=r(12),c=function(e){function t(t,r,n,i){var c=e.call(this,Object(a.c)("default_event"),r,"DefaultEvent")||this;return c.event[Object(a.c)("client_id")]=n,c.event[Object(a.c)("sdk_plaform")]=t.sdk,c.event[Object(a.c)("sdk_version")]=t.sdkVersion,c.event[Object(a.c)("application_name")]=t.applicationName,c.event[Object(a.c)("application_version")]=t.applicationVersion,c.event[Object(a.c)("effective_connection_speed")]=t.networkInformation&&t.networkInformation.connectionSpeed,c.event[""+o.e.UiEventCountTelemetryBatchKey]=c.getEventCount(Object(a.c)("ui_event"),i),c.event[""+o.e.HttpEventCountTelemetryBatchKey]=c.getEventCount(Object(a.c)("http_event"),i),c.event[""+o.e.CacheEventCountConstStrKey]=c.getEventCount(Object(a.c)("cache_event"),i),c}return n.d(t,e),t.prototype.getEventCount=function(e,t){return t[e]?t[e]:0},t}(i.a),s=r(2),u=r(170),l=r(283),d=function(){function e(e,t,r){this.completedEvents={},this.inProgressEvents={},this.eventCountByCorrelationId={},this.onlySendFailureTelemetry=!1,this.telemetryPlatform=n.a({sdk:s.c.libraryName,sdkVersion:Object(s.k)(),networkInformation:{connectionSpeed:"undefined"!=typeof navigator&&navigator.connection&&navigator.connection.effectiveType}},e.platform),this.clientId=e.clientId,this.onlySendFailureTelemetry=e.onlySendFailureTelemetry,this.telemetryEmitter=t,this.logger=r}return e.getTelemetrymanagerStub=function(e,t){return new this({platform:{applicationName:"UnSetStub",applicationVersion:"0.0"},clientId:e},(function(){}),t)},e.prototype.startEvent=function(e){this.logger.verbose("Telemetry Event started: "+e.key),this.telemetryEmitter&&(e.start(),this.inProgressEvents[e.key]=e)},e.prototype.stopEvent=function(e){if(this.logger.verbose("Telemetry Event stopped: "+e.key),this.telemetryEmitter&&this.inProgressEvents[e.key]){e.stop(),this.incrementEventCount(e);var t=this.completedEvents[e.telemetryCorrelationId];this.completedEvents[e.telemetryCorrelationId]=(t||[]).concat([e]),delete this.inProgressEvents[e.key]}},e.prototype.flush=function(e){var t=this;if(this.logger.verbose("Flushing telemetry events: "+e),this.telemetryEmitter&&this.completedEvents[e]){var r=this.getOrphanedEvents(e);r.forEach((function(e){return t.incrementEventCount(e)}));var n=this.completedEvents[e].concat(r);delete this.completedEvents[e];var o=this.eventCountByCorrelationId[e];if(delete this.eventCountByCorrelationId[e],n&&n.length){var i=new c(this.telemetryPlatform,e,this.clientId,o),a=n.concat([i]);this.telemetryEmitter(a.map((function(e){return e.get()})))}}},e.prototype.createAndStartApiEvent=function(e,t){var r=new u.b(e,this.logger.isPiiLoggingEnabled(),t);return this.startEvent(r),r},e.prototype.stopAndFlushApiEvent=function(e,t,r,n){t.wasSuccessful=r,n&&(t.apiErrorCode=n),this.stopEvent(t),this.flush(e)},e.prototype.createAndStartHttpEvent=function(e,t,r,n){var o=new l.a(e,n);return o.url=r,o.httpMethod=t,this.startEvent(o),o},e.prototype.incrementEventCount=function(e){var t,r=e.eventName,n=this.eventCountByCorrelationId[e.telemetryCorrelationId];n?n[r]=n[r]?n[r]+1:1:this.eventCountByCorrelationId[e.telemetryCorrelationId]=((t={})[r]=1,t)},e.prototype.getOrphanedEvents=function(e){var t=this;return Object.keys(this.inProgressEvents).reduce((function(r,n){if(-1!==n.indexOf(e)){var o=t.inProgressEvents[n];return delete t.inProgressEvents[n],r.concat([o])}return r}),[])},e}();t.a=d},406:function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return U}));var n=r(1),o=r(354),i=r(355),a=r(144),c=r(189),s=r(171),u=r(110),l=r(109),d=r(98),h=r(22),p=r(57),f=r(245),g=r(188),m=r(19),y=r(137),v=r(284),I=r(85),b=r(440),w=r(27),E=r(70),T=r(16),S=r(185),C=r(187),A=r(246),_=r(356),k=r(170),O=r(2),R=r(33),P="id_token",N="token",j="id_token token",U=function(){function t(e){this.authResponseCallback=null,this.tokenReceivedCallback=null,this.errorReceivedCallback=null,this.config=Object(b.a)(e),this.logger=this.config.system.logger,this.clientId=this.config.auth.clientId,this.inCookie=this.config.cache.storeAuthStateInCookie,this.telemetryManager=this.getTelemetryManagerFromConfig(this.config.system.telemetry,this.clientId),I.a.setKnownAuthorities(this.config.auth.validateAuthority,this.config.auth.knownAuthorities),I.a.saveMetadataFromConfig(this.config.auth.authority,this.config.auth.authorityMetadata),this.authority=this.config.auth.authority||"https://login.microsoftonline.com/common",this.cacheStorage=new u.a(this.clientId,this.config.cache.cacheLocation,this.inCookie),window.activeRenewals={},window.renewStates=[],window.callbackMappedToRenewStates={},window.promiseMappedToRenewStates={},window.msal=this;var t=window.location.hash,r=m.a.urlContainsHash(t);(p.a.checkIfBackButtonIsPressed(this.cacheStorage),r)&&(this.getResponseState(t).method===O.c.interactionTypeRedirect&&this.handleRedirectAuthenticationResponse(t))}return Object.defineProperty(t.prototype,"authority",{get:function(){return this.authorityInstance.CanonicalAuthority},set:function(e){this.authorityInstance=I.a.CreateInstance(e,this.config.auth.validateAuthority)},enumerable:!0,configurable:!0}),t.prototype.getAuthorityInstance=function(){return this.authorityInstance},t.prototype.handleRedirectCallback=function(e,t){if(!e)throw w.a.createInvalidCallbackObjectError(e);t?(this.tokenReceivedCallback=e,this.errorReceivedCallback=t,this.logger.warning("This overload for callback is deprecated - please change the format of the callbacks to a single callback as shown: (err: AuthError, response: AuthResponse).")):this.authResponseCallback=e,this.redirectError?this.authErrorHandler(O.c.interactionTypeRedirect,this.redirectError,this.redirectResponse):this.redirectResponse&&this.authResponseHandler(O.c.interactionTypeRedirect,this.redirectResponse)},t.prototype.urlContainsHash=function(e){return m.a.urlContainsHash(e)},t.prototype.authResponseHandler=function(e,t,r){if(e===O.c.interactionTypeRedirect)this.errorReceivedCallback?this.tokenReceivedCallback(t):this.authResponseCallback&&this.authResponseCallback(null,t);else{if(e!==O.c.interactionTypePopup)throw T.a.createInvalidInteractionTypeError();r(t)}},t.prototype.authErrorHandler=function(e,t,r,n){if(this.cacheStorage.removeItem(O.j.INTERACTION_STATUS),e===O.c.interactionTypeRedirect)this.errorReceivedCallback?this.errorReceivedCallback(t,r.accountState):this.authResponseCallback(t,r);else{if(e!==O.c.interactionTypePopup)throw T.a.createInvalidInteractionTypeError();n(t)}},t.prototype.loginRedirect=function(e){var t=y.a.validateRequest(e,!0,this.clientId,O.c.interactionTypeRedirect);this.acquireTokenInteractive(O.c.interactionTypeRedirect,!0,t,null,null)},t.prototype.acquireTokenRedirect=function(e){var t=y.a.validateRequest(e,!1,this.clientId,O.c.interactionTypeRedirect);this.acquireTokenInteractive(O.c.interactionTypeRedirect,!1,t,null,null)},t.prototype.loginPopup=function(t){var r=this,n=y.a.validateRequest(t,!0,this.clientId,O.c.interactionTypePopup),o=this.telemetryManager.createAndStartApiEvent(n.correlationId,k.a.LoginPopup);return new e((function(e,t){r.acquireTokenInteractive(O.c.interactionTypePopup,!0,n,e,t)})).then((function(e){return r.telemetryManager.stopAndFlushApiEvent(n.correlationId,o,!0),e})).catch((function(e){throw r.cacheStorage.resetTempCacheItems(n.state),r.telemetryManager.stopAndFlushApiEvent(n.correlationId,o,!1,e.errorCode),e}))},t.prototype.acquireTokenPopup=function(t){var r=this;this.logger.verbose("AcquireTokenPopup has been called");var n=y.a.validateRequest(t,!1,this.clientId,O.c.interactionTypePopup),o=this.telemetryManager.createAndStartApiEvent(n.correlationId,k.a.AcquireTokenPopup);return new e((function(e,t){r.acquireTokenInteractive(O.c.interactionTypePopup,!1,n,e,t)})).then((function(e){return r.logger.verbose("Successfully acquired token"),r.telemetryManager.stopAndFlushApiEvent(n.correlationId,o,!0),e})).catch((function(e){throw r.cacheStorage.resetTempCacheItems(n.state),r.telemetryManager.stopAndFlushApiEvent(n.correlationId,o,!1,e.errorCode),e}))},t.prototype.acquireTokenInteractive=function(e,t,r,n,o){var i=this;this.logger.verbose("AcquireTokenInteractive has been called"),p.a.blockReloadInHiddenIframes();var c,s=this.cacheStorage.getItem(O.j.INTERACTION_STATUS);if(e===O.c.interactionTypeRedirect&&this.cacheStorage.setItem(O.j.REDIRECT_REQUEST,""+O.c.inProgress+O.c.resourceDelimiter+r.state),s===O.c.inProgress){var u=t?T.a.createLoginInProgressError():T.a.createAcquireTokenInProgressError(),l=Object(A.a)(this.getAccountState(r.state));return this.cacheStorage.resetTempCacheItems(r.state),void this.authErrorHandler(e,u,l,o)}if(r&&r.account&&!t?(c=r.account,this.logger.verbose("Account set from request")):(c=this.getAccount(),this.logger.verbose("Account set from MSAL Cache")),c||a.a.isSSOParam(r))this.logger.verbose("User session exists, login not required"),this.acquireTokenHelper(c,e,t,r,n,o);else{if(!t){this.logger.verbose("AcquireToken call, no context or account given"),this.logger.info("User login is required");l=Object(A.a)(this.getAccountState(r.state));return this.cacheStorage.resetTempCacheItems(r.state),void this.authErrorHandler(e,T.a.createUserLoginRequiredError(),l,o)}if(this.extractADALIdToken()&&!r.scopes){this.logger.info("ADAL's idToken exists. Extracting login information from ADAL's idToken");var d=this.buildIDTokenRequest(r);this.silentLogin=!0,this.acquireTokenSilent(d).then((function(t){i.silentLogin=!1,i.logger.info("Unified cache call is successful"),i.authResponseHandler(e,t,n)}),(function(a){i.silentLogin=!1,i.logger.error("Error occurred during unified cache ATS: "+a),i.acquireTokenHelper(null,e,t,r,n,o)}))}else this.logger.verbose("Login call but no token found, proceed to login"),this.acquireTokenHelper(null,e,t,r,n,o)}},t.prototype.acquireTokenHelper=function(e,t,r,o,i,c){return n.b(this,void 0,void 0,(function(){var s,u,l,d,h,f,g,y,v,b;return n.e(this,(function(n){switch(n.label){case 0:this.cacheStorage.setItem(O.j.INTERACTION_STATUS,O.c.inProgress),s=o.scopes?o.scopes.join(" ").toLowerCase():this.clientId.toLowerCase(),l=o&&o.authority?I.a.CreateInstance(o.authority,this.config.auth.validateAuthority,o.authorityMetadata):this.authorityInstance,n.label=1;case 1:return n.trys.push([1,11,,12]),l.hasCachedMetadata()?[3,3]:(this.logger.verbose("No cached metadata for authority"),[4,I.a.saveMetadataFromNetwork(l,this.telemetryManager,o.correlationId)]);case 2:return n.sent(),[3,4];case 3:this.logger.verbose("Cached metadata found for authority"),n.label=4;case 4:if(h=r?P:this.getTokenType(e,o.scopes,!1),f=o.redirectStartPage||window.location.href,u=new a.a(l,this.clientId,h,this.getRedirectUri(o&&o.redirectUri),o.scopes,o.state,o.correlationId),this.updateCacheEntries(u,e,r,f),u.populateQueryParams(e,o),g=m.a.createNavigateUrl(u)+O.c.response_mode_fragment,t===O.c.interactionTypeRedirect)r||this.cacheStorage.setItem(""+O.j.STATE_ACQ_TOKEN+O.c.resourceDelimiter+o.state,u.state,this.inCookie);else{if(t!==O.c.interactionTypePopup)throw T.a.createInvalidInteractionTypeError();window.renewStates.push(u.state),window.requestType=r?O.c.login:O.c.renewToken,this.registerCallback(u.state,s,i,c)}if(t!==O.c.interactionTypePopup)return[3,9];try{d=this.openPopup(g,"msal",O.c.popUpWidth,O.c.popUpHeight),p.a.trackPopup(d)}catch(e){if(this.logger.info(T.b.popUpWindowError.code+":"+T.b.popUpWindowError.desc),this.cacheStorage.setItem(O.d.ERROR,T.b.popUpWindowError.code),this.cacheStorage.setItem(O.d.ERROR_DESC,T.b.popUpWindowError.desc),c)return c(T.a.createPopupWindowError()),[2]}if(!d)return[3,8];n.label=5;case 5:return n.trys.push([5,7,,8]),[4,p.a.monitorWindowForHash(d,this.config.system.loadFrameTimeout,g,this.logger)];case 6:return y=n.sent(),this.handleAuthenticationResponse(y),this.cacheStorage.removeItem(O.j.INTERACTION_STATUS),this.logger.info("Closing popup window"),this.config.framework.isAngular&&(this.broadcast("msal:popUpHashChanged",y),p.a.closePopups()),[3,8];case 7:return v=n.sent(),c&&c(v),this.config.framework.isAngular?this.broadcast("msal:popUpClosed",v.errorCode+O.c.resourceDelimiter+v.errorMessage):(this.cacheStorage.removeItem(O.j.INTERACTION_STATUS),d.close()),[3,8];case 8:return[3,10];case 9:o.onRedirectNavigate?(this.logger.verbose("Invoking onRedirectNavigate callback"),!1!==o.onRedirectNavigate(g)?(this.logger.verbose("onRedirectNavigate did not return false, navigating"),this.navigateWindow(g)):this.logger.verbose("onRedirectNavigate returned false, stopping navigation")):(this.logger.verbose("Navigating window to urlNavigate"),this.navigateWindow(g)),n.label=10;case 10:return[3,12];case 11:return b=n.sent(),this.logger.error(b),this.cacheStorage.resetTempCacheItems(o.state),this.authErrorHandler(t,T.a.createEndpointResolutionError(b.toString),Object(A.a)(o.state),c),d&&d.close(),[3,12];case 12:return[2]}}))}))},t.prototype.ssoSilent=function(e){if(!e)throw w.a.createEmptyRequestError();if(!e.sid&&!e.loginHint)throw w.a.createSsoSilentError();return this.acquireTokenSilent(n.a({},e,{scopes:[this.clientId]}))},t.prototype.acquireTokenSilent=function(t){var r=this;this.logger.verbose("AcquireTokenSilent has been called");var o=y.a.validateRequest(t,!1,this.clientId,O.c.interactionTypeSilent),i=this.telemetryManager.createAndStartApiEvent(o.correlationId,k.a.AcquireTokenSilent),c=y.a.createRequestSignature(o);return new e((function(e,t){return n.b(r,void 0,void 0,(function(){var r,i,s,u,l,d,g,m,y,v,b;return n.e(this,(function(n){switch(n.label){case 0:if(p.a.blockReloadInHiddenIframes(),r=o.scopes.join(" ").toLowerCase(),this.logger.verbosePii("Serialized scopes: "+r),o.account?(i=o.account,this.logger.verbose("Account set from request")):(i=this.getAccount(),this.logger.verbose("Account set from MSAL Cache")),s=this.cacheStorage.getItem(O.c.adalIdToken),!i&&!o.sid&&!o.loginHint&&h.a.isEmpty(s))return this.logger.info("User login is required"),[2,t(T.a.createUserLoginRequiredError())];if(u=this.getTokenType(i,o.scopes,!0),this.logger.verbose("Response type: "+u),l=new a.a(I.a.CreateInstance(o.authority,this.config.auth.validateAuthority,o.authorityMetadata),this.clientId,u,this.getRedirectUri(o.redirectUri),o.scopes,o.state,o.correlationId),this.logger.verbose("Finished building server authentication request"),a.a.isSSOParam(o)||i?(l.populateQueryParams(i,o,null,!0),this.logger.verbose("Query parameters populated from existing SSO or account")):i||h.a.isEmpty(s)?this.logger.verbose("No additional query parameters added"):(d=f.a.extractIdToken(s),this.logger.verbose("ADAL's idToken exists. Extracting login information from ADAL's idToken to populate query parameters"),l.populateQueryParams(i,null,d,!0)),!(g=o.claimsRequest||l.claimsValue)&&!o.forceRefresh)try{y=this.getCachedToken(l,i)}catch(e){m=e}return y?(this.logger.verbose("Token is already in cache for scope: "+r),e(y),[2,null]):[3,1];case 1:return m?(this.logger.infoPii(m.errorCode+":"+m.errorMessage),t(m),[2,null]):[3,2];case 2:v=void 0,v=g?"Skipped cache lookup since claims were given":o.forceRefresh?"Skipped cache lookup since request.forceRefresh option was set to true":"Token is not in cache for scope: "+r,this.logger.verbose(v),l.authorityInstance||(l.authorityInstance=o.authority?I.a.CreateInstance(o.authority,this.config.auth.validateAuthority,o.authorityMetadata):this.authorityInstance),this.logger.verbosePii("Authority instance: "+l.authority),n.label=3;case 3:return n.trys.push([3,7,,8]),l.authorityInstance.hasCachedMetadata()?[3,5]:(this.logger.verbose("No cached metadata for authority"),[4,I.a.saveMetadataFromNetwork(l.authorityInstance,this.telemetryManager,o.correlationId)]);case 4:return n.sent(),this.logger.verbose("Authority has been updated with endpoint discovery response"),[3,6];case 5:this.logger.verbose("Cached metadata found for authority"),n.label=6;case 6:return window.activeRenewals[c]?(this.logger.verbose("Renew token for scope and authority: "+c+" is in progress. Registering callback"),this.registerCallback(window.activeRenewals[c],c,e,t)):o.scopes&&o.scopes.indexOf(this.clientId)>-1&&1===o.scopes.length?(this.logger.verbose("Renewing idToken"),this.silentLogin=!0,this.renewIdToken(c,e,t,i,l)):(this.logger.verbose("Renewing accesstoken"),this.renewToken(c,e,t,i,l)),[3,8];case 7:return b=n.sent(),this.logger.error(b),t(T.a.createEndpointResolutionError(b.toString())),[2,null];case 8:return[2]}}))}))})).then((function(e){return r.logger.verbose("Successfully acquired token"),r.telemetryManager.stopAndFlushApiEvent(o.correlationId,i,!0),e})).catch((function(e){throw r.cacheStorage.resetTempCacheItems(o.state),r.telemetryManager.stopAndFlushApiEvent(o.correlationId,i,!1,e.errorCode),e}))},t.prototype.openPopup=function(e,t,r,n){try{var o=window.screenLeft?window.screenLeft:window.screenX,i=window.screenTop?window.screenTop:window.screenY,a=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,c=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,s=a/2-r/2+o,u=c/2-n/2+i,l=window.open(e,t,"width="+r+", height="+n+", top="+u+", left="+s+", scrollbars=yes");if(!l)throw T.a.createPopupWindowError();return l.focus&&l.focus(),l}catch(e){throw this.logger.error("error opening popup "+e.message),this.cacheStorage.removeItem(O.j.INTERACTION_STATUS),T.a.createPopupWindowError(e.toString())}},t.prototype.loadIframeTimeout=function(e,t,r){return n.b(this,void 0,void 0,(function(){var o,i,a,c,s;return n.e(this,(function(n){switch(n.label){case 0:return o=window.activeRenewals[r],this.logger.verbosePii("Set loading state to pending for: "+r+":"+o),this.cacheStorage.setItem(""+O.j.RENEW_STATUS+O.c.resourceDelimiter+o,O.c.inProgress),this.config.system.navigateFrameWait?[4,p.a.loadFrame(e,t,this.config.system.navigateFrameWait,this.logger)]:[3,2];case 1:return a=n.sent(),[3,3];case 2:a=p.a.loadFrameSync(e,t,this.logger),n.label=3;case 3:i=a,n.label=4;case 4:return n.trys.push([4,6,,7]),[4,p.a.monitorWindowForHash(i.contentWindow,this.config.system.loadFrameTimeout,e,this.logger,!0)];case 5:return(c=n.sent())&&this.handleAuthenticationResponse(c),[3,7];case 6:throw s=n.sent(),this.cacheStorage.getItem(""+O.j.RENEW_STATUS+O.c.resourceDelimiter+o)===O.c.inProgress&&(this.logger.verbose("Loading frame has timed out after: "+this.config.system.loadFrameTimeout/1e3+" seconds for scope/authority "+r+":"+o),o&&window.callbackMappedToRenewStates[o]&&window.callbackMappedToRenewStates[o](null,s),this.cacheStorage.removeItem(""+O.j.RENEW_STATUS+O.c.resourceDelimiter+o)),p.a.removeHiddenIframe(i),s;case 7:return p.a.removeHiddenIframe(i),[2]}}))}))},t.prototype.navigateWindow=function(e,t){if(!e||h.a.isEmpty(e))throw this.logger.info("Navigate url is empty"),E.a.createUnexpectedError("Navigate url is empty");var r=t||window,n=t?"Navigated Popup window to:"+e:"Navigate to:"+e;this.logger.infoPii(n),r.location.assign(e)},t.prototype.registerCallback=function(e,t,r,n){var o=this;window.activeRenewals[t]=e,window.promiseMappedToRenewStates[e]||(window.promiseMappedToRenewStates[e]=[]),window.promiseMappedToRenewStates[e].push({resolve:r,reject:n}),window.callbackMappedToRenewStates[e]||(window.callbackMappedToRenewStates[e]=function(r,n){window.activeRenewals[t]=null;for(var i=0;i<window.promiseMappedToRenewStates[e].length;++i)try{if(n)window.promiseMappedToRenewStates[e][i].reject(n);else{if(!r)throw o.cacheStorage.resetTempCacheItems(e),E.a.createUnexpectedError("Error and response are both null");window.promiseMappedToRenewStates[e][i].resolve(r)}}catch(e){o.logger.warning(e)}window.promiseMappedToRenewStates[e]=null,window.callbackMappedToRenewStates[e]=null})},t.prototype.logout=function(e){this.logoutAsync(e)},t.prototype.logoutAsync=function(e){return n.b(this,void 0,void 0,(function(){var t,r,o,i,a,c;return n.e(this,(function(n){switch(n.label){case 0:t=e||R.a.createNewGuid(),r=this.telemetryManager.createAndStartApiEvent(t,k.a.Logout),this.clearCache(),this.account=null,n.label=1;case 1:return n.trys.push([1,5,,6]),this.authorityInstance.hasCachedMetadata()?[3,3]:(this.logger.verbose("No cached metadata for authority"),[4,I.a.saveMetadataFromNetwork(this.authorityInstance,this.telemetryManager,e)]);case 2:return n.sent(),[3,4];case 3:this.logger.verbose("Cached metadata found for authority"),n.label=4;case 4:return o="client-request-id="+t,i=this.getPostLogoutRedirectUri()?"&post_logout_redirect_uri="+encodeURIComponent(this.getPostLogoutRedirectUri()):"",a=this.authorityInstance.EndSessionEndpoint?this.authorityInstance.EndSessionEndpoint+"?"+o+i:this.authority+"oauth2/v2.0/logout?"+o+i,this.telemetryManager.stopAndFlushApiEvent(t,r,!0),this.navigateWindow(a),[3,6];case 5:return c=n.sent(),this.telemetryManager.stopAndFlushApiEvent(t,r,!1,c.errorCode),[3,6];case 6:return[2]}}))}))},t.prototype.clearCache=function(){window.renewStates=[];for(var e=this.cacheStorage.getAllAccessTokens(O.c.clientId,O.c.homeAccountIdentifier),t=0;t<e.length;t++)this.cacheStorage.removeItem(JSON.stringify(e[t].key));this.cacheStorage.resetCacheItems(),this.cacheStorage.clearMsalCookie()},t.prototype.clearCacheForScope=function(e){for(var t=this.cacheStorage.getAllAccessTokens(O.c.clientId,O.c.homeAccountIdentifier),r=0;r<t.length;r++){var n=t[r];n.value.accessToken===e&&this.cacheStorage.removeItem(JSON.stringify(n.key))}},t.prototype.isCallback=function(e){return this.logger.info("isCallback will be deprecated in favor of urlContainsHash in MSAL.js v2.0."),m.a.urlContainsHash(e)},t.prototype.processCallBack=function(e,t,r){var n,o;this.logger.info("Processing the callback from redirect response"),t||(t=this.getResponseState(e));try{n=this.saveTokenFromHash(e,t)}catch(e){o=e}try{this.cacheStorage.clearMsalCookie(t.state);var i=this.getAccountState(t.state);if(n){if(t.requestType===O.c.renewToken||n.accessToken?(window.parent!==window?this.logger.verbose("Window is in iframe, acquiring token silently"):this.logger.verbose("acquiring token interactive in progress"),n.tokenType=O.i.ACCESS_TOKEN):t.requestType===O.c.login&&(n.tokenType=O.i.ID_TOKEN),!r)return void(this.redirectResponse=n)}else if(!r)return this.redirectResponse=Object(A.a)(i),this.redirectError=o,void this.cacheStorage.resetTempCacheItems(t.state);r(n,o)}catch(e){throw this.logger.error("Error occurred in token received callback function: "+e),T.a.createErrorInCallbackFunction(e.toString())}},t.prototype.handleAuthenticationResponse=function(e){var t=e||window.location.hash,r=this.getResponseState(t),n=window.callbackMappedToRenewStates[r.state];this.processCallBack(t,r,n),p.a.closePopups()},t.prototype.handleRedirectAuthenticationResponse=function(e){this.logger.info("Returned from redirect url"),window.location.hash="";var t=this.getResponseState(e);if(this.config.auth.navigateToLoginRequestUrl&&window.parent===window){var r=this.cacheStorage.getItem(""+O.j.LOGIN_REQUEST+O.c.resourceDelimiter+t.state,this.inCookie);if(!r||"null"===r)return this.logger.error("Unable to get valid login request url from cache, redirecting to home page"),void window.location.assign("/");var n=m.a.removeHashFromUrl(window.location.href),o=m.a.removeHashFromUrl(r);if(n!==o)return void window.location.assign(""+o+e);var i=m.a.GetUrlComponents(r);i.Hash&&(window.location.hash=i.Hash)}this.processCallBack(e,t,null)},t.prototype.getResponseState=function(e){var t,r=m.a.deserializeHash(e);if(!r)throw E.a.createUnexpectedError("Hash was not parsed correctly.");if(!r.hasOwnProperty(O.i.STATE))throw E.a.createUnexpectedError("Hash does not contain state.");var n=y.a.parseLibraryState(r.state);if((t={requestType:O.c.unknown,state:r.state,timestamp:n.ts,method:n.method,stateMatch:!1}).state===this.cacheStorage.getItem(""+O.j.STATE_LOGIN+O.c.resourceDelimiter+t.state,this.inCookie)||t.state===this.silentAuthenticationState)return t.requestType=O.c.login,t.stateMatch=!0,t;if(t.state===this.cacheStorage.getItem(""+O.j.STATE_ACQ_TOKEN+O.c.resourceDelimiter+t.state,this.inCookie))return t.requestType=O.c.renewToken,t.stateMatch=!0,t;if(!t.stateMatch){t.requestType=window.requestType;for(var o=window.renewStates,i=0;i<o.length;i++)if(o[i]===t.state){t.stateMatch=!0;break}}return t},t.prototype.getCachedToken=function(e,t){var r=null,n=e.scopes,o=this.cacheStorage.getAllAccessTokens(this.clientId,t?t.homeAccountIdentifier:null);if(0===o.length)return null;var i=[];if(e.authority){for(a=0;a<o.length;a++){u=(c=o[a]).key.scopes.split(" ");d.a.containsScope(u,n)&&m.a.CanonicalizeUri(c.key.authority)===e.authority&&i.push(c)}if(0===i.length)return null;if(1!==i.length)throw T.a.createMultipleMatchingTokensInCacheError(n.toString());r=i[0]}else{for(var a=0;a<o.length;a++){var c,u=(c=o[a]).key.scopes.split(" ");d.a.containsScope(u,n)&&i.push(c)}if(1===i.length)r=i[0],e.authorityInstance=I.a.CreateInstance(r.key.authority,this.config.auth.validateAuthority);else{if(i.length>1)throw T.a.createMultipleMatchingTokensInCacheError(n.toString());var l=this.getUniqueAuthority(o,"authority");if(l.length>1)throw T.a.createMultipleAuthoritiesInCacheError(n.toString());e.authorityInstance=I.a.CreateInstance(l[0],this.config.auth.validateAuthority)}}if(null!=r){var h=Number(r.value.expiresIn),p=this.config.system.tokenRenewalOffsetSeconds||300;if(h&&h>g.a.now()+p){var f=new s.a(r.value.idToken);if(!t&&!(t=this.getAccount()))throw E.a.createUnexpectedError("Account should not be null here.");var y=this.getAccountState(e.state),b={uniqueId:"",tenantId:"",tokenType:r.value.idToken===r.value.accessToken?O.i.ID_TOKEN:O.i.ACCESS_TOKEN,idToken:f,idTokenClaims:f.claims,accessToken:r.value.accessToken,scopes:r.key.scopes.split(" "),expiresOn:new Date(1e3*h),account:t,accountState:y,fromCache:!0};return v.a.setResponseIdToken(b,f),b}return this.cacheStorage.removeItem(JSON.stringify(i[0].key)),null}return null},t.prototype.getUniqueAuthority=function(e,t){var r=[],n=[];return e.forEach((function(e){e.key.hasOwnProperty(t)&&-1===n.indexOf(e.key[t])&&(n.push(e.key[t]),r.push(e.key[t]))})),r},t.prototype.extractADALIdToken=function(){var e=this.cacheStorage.getItem(O.c.adalIdToken);return h.a.isEmpty(e)?null:f.a.extractIdToken(e)},t.prototype.renewToken=function(e,t,r,n,o){this.logger.verbose("renewToken is called for scope and authority: "+e);var i=p.a.generateFrameName(O.e.TOKEN_FRAME,e);p.a.addHiddenIFrame(i,this.logger),this.updateCacheEntries(o,n,!1),this.logger.verbosePii("Renew token Expected state: "+o.state);var a=m.a.urlRemoveQueryStringParameter(m.a.createNavigateUrl(o),O.c.prompt)+O.c.prompt_none+O.c.response_mode_fragment;window.renewStates.push(o.state),window.requestType=O.c.renewToken,this.registerCallback(o.state,e,t,r),this.logger.infoPii("Navigate to:"+a),this.loadIframeTimeout(a,i,e).catch((function(e){return r(e)}))},t.prototype.renewIdToken=function(e,t,r,n,o){this.logger.info("renewidToken is called");var i=p.a.generateFrameName(O.e.ID_TOKEN_FRAME,e);p.a.addHiddenIFrame(i,this.logger),this.updateCacheEntries(o,n,!1),this.logger.verbose("Renew Idtoken Expected state: "+o.state);var a=m.a.urlRemoveQueryStringParameter(m.a.createNavigateUrl(o),O.c.prompt)+O.c.prompt_none+O.c.response_mode_fragment;this.silentLogin?(window.requestType=O.c.login,this.silentAuthenticationState=o.state):(window.requestType=O.c.renewToken,window.renewStates.push(o.state)),this.registerCallback(o.state,e,t,r),this.logger.infoPii("Navigate to:"+a),this.loadIframeTimeout(a,i,e).catch((function(e){return r(e)}))},t.prototype.saveAccessToken=function(e,t,r,a,s){var u,l,h=n.a({},e),p=new c.a(a);if(r.hasOwnProperty(O.i.SCOPE)){for(var f=(u=r[O.i.SCOPE]).split(" "),m=this.cacheStorage.getAllAccessTokens(this.clientId,t),v=0;v<m.length;v++){var I=m[v];if(I.key.homeAccountIdentifier===e.account.homeAccountIdentifier){var b=I.key.scopes.split(" ");d.a.isIntersectingScopes(b,f)&&this.cacheStorage.removeItem(JSON.stringify(I.key))}}var w=g.a.parseExpiresIn(r[O.i.EXPIRES_IN]);l=y.a.parseLibraryState(r[O.i.STATE]).ts+w;var E=new o.a(t,this.clientId,u,p.uid,p.utid),T=new i.a(r[O.i.ACCESS_TOKEN],s.rawIdToken,l.toString(),a);this.cacheStorage.setItem(JSON.stringify(E),JSON.stringify(T)),h.accessToken=r[O.i.ACCESS_TOKEN],h.scopes=f}else{u=this.clientId;E=new o.a(t,this.clientId,u,p.uid,p.utid);l=Number(s.expiration);T=new i.a(r[O.i.ID_TOKEN],r[O.i.ID_TOKEN],l.toString(),a);this.cacheStorage.setItem(JSON.stringify(E),JSON.stringify(T)),h.scopes=[u],h.accessToken=r[O.i.ID_TOKEN]}return l?h.expiresOn=new Date(1e3*l):this.logger.error("Could not parse expiresIn parameter"),h},t.prototype.saveTokenFromHash=function(e,t){this.logger.info("State status:"+t.stateMatch+"; Request type:"+t.requestType);var r,n={uniqueId:"",tenantId:"",tokenType:"",idToken:null,idTokenClaims:null,accessToken:null,scopes:[],expiresOn:null,account:null,accountState:"",fromCache:!1},o=m.a.deserializeHash(e),i="",a="",d=null;if(o.hasOwnProperty(O.i.ERROR_DESCRIPTION)||o.hasOwnProperty(O.i.ERROR)){if(this.logger.infoPii("Error :"+o[O.i.ERROR]+"; Error description:"+o[O.i.ERROR_DESCRIPTION]),this.cacheStorage.setItem(O.d.ERROR,o[O.i.ERROR]),this.cacheStorage.setItem(O.d.ERROR_DESC,o[O.i.ERROR_DESCRIPTION]),t.requestType===O.c.login&&(this.cacheStorage.setItem(O.d.LOGIN_ERROR,o[O.i.ERROR_DESCRIPTION]+":"+o[O.i.ERROR]),i=u.a.generateAuthorityKey(t.state)),t.requestType===O.c.renewToken){i=u.a.generateAuthorityKey(t.state);var p=this.getAccount(),f=void 0;f=p&&!h.a.isEmpty(p.homeAccountIdentifier)?p.homeAccountIdentifier:O.c.no_account,a=u.a.generateAcquireTokenAccountKey(f,t.state)}var g=o[O.i.ERROR],y=o[O.i.ERROR_DESCRIPTION];r=C.a.isInteractionRequiredError(g)||C.a.isInteractionRequiredError(y)?new C.a(o[O.i.ERROR],o[O.i.ERROR_DESCRIPTION]):new S.a(o[O.i.ERROR],o[O.i.ERROR_DESCRIPTION])}else if(t.stateMatch){this.logger.info("State is right"),o.hasOwnProperty(O.i.SESSION_STATE)&&this.cacheStorage.setItem(""+O.j.SESSION_STATE+O.c.resourceDelimiter+t.state,o[O.i.SESSION_STATE]),n.accountState=this.getAccountState(t.state);var I="";if(o.hasOwnProperty(O.i.ACCESS_TOKEN)){this.logger.info("Fragment has access token"),n.accessToken=o[O.i.ACCESS_TOKEN],o.hasOwnProperty(O.i.SCOPE)&&(n.scopes=o[O.i.SCOPE].split(" ")),o.hasOwnProperty(O.i.ID_TOKEN)?(d=new s.a(o[O.i.ID_TOKEN]),n.idToken=d,n.idTokenClaims=d.claims):(d=new s.a(this.cacheStorage.getItem(O.f.IDTOKEN)),n=v.a.setResponseIdToken(n,d));var b=this.populateAuthority(t.state,this.inCookie,this.cacheStorage,d);if(!o.hasOwnProperty(O.i.CLIENT_INFO))throw this.logger.warning("ClientInfo not received in the response from AAD"),T.a.createClientInfoNotPopulatedError("ClientInfo not received in the response from the server");I=o[O.i.CLIENT_INFO],n.account=l.a.createAccount(d,new c.a(I));var w=void 0;w=n.account&&!h.a.isEmpty(n.account.homeAccountIdentifier)?n.account.homeAccountIdentifier:O.c.no_account,a=u.a.generateAcquireTokenAccountKey(w,t.state);var A=u.a.generateAcquireTokenAccountKey(O.c.no_account,t.state),_=this.cacheStorage.getItem(a),k=void 0;h.a.isEmpty(_)?h.a.isEmpty(this.cacheStorage.getItem(A))||(n=this.saveAccessToken(n,b,o,I,d)):(k=JSON.parse(_),n.account&&k&&l.a.compareAccounts(n.account,k)?(n=this.saveAccessToken(n,b,o,I,d),this.logger.info("The user object received in the response is the same as the one passed in the acquireToken request")):this.logger.warning("The account object created from the response is not the same as the one passed in the acquireToken request"))}if(o.hasOwnProperty(O.i.ID_TOKEN)){this.logger.info("Fragment has id token"),d=new s.a(o[O.i.ID_TOKEN]),n=v.a.setResponseIdToken(n,d),o.hasOwnProperty(O.i.CLIENT_INFO)?I=o[O.i.CLIENT_INFO]:this.logger.warning("ClientInfo not received in the response from AAD");b=this.populateAuthority(t.state,this.inCookie,this.cacheStorage,d);this.account=l.a.createAccount(d,new c.a(I)),n.account=this.account,d&&d.nonce?d.nonce!==this.cacheStorage.getItem(""+O.j.NONCE_IDTOKEN+O.c.resourceDelimiter+t.state,this.inCookie)?(this.account=null,this.cacheStorage.setItem(O.d.LOGIN_ERROR,"Nonce Mismatch. Expected Nonce: "+this.cacheStorage.getItem(""+O.j.NONCE_IDTOKEN+O.c.resourceDelimiter+t.state,this.inCookie)+",Actual Nonce: "+d.nonce),this.logger.error("Nonce Mismatch.Expected Nonce: "+this.cacheStorage.getItem(""+O.j.NONCE_IDTOKEN+O.c.resourceDelimiter+t.state,this.inCookie)+",Actual Nonce: "+d.nonce),r=T.a.createNonceMismatchError(this.cacheStorage.getItem(""+O.j.NONCE_IDTOKEN+O.c.resourceDelimiter+t.state,this.inCookie),d.nonce)):(this.cacheStorage.setItem(O.f.IDTOKEN,o[O.i.ID_TOKEN]),this.cacheStorage.setItem(O.f.CLIENT_INFO,I),this.saveAccessToken(n,b,o,I,d)):(i=t.state,a=t.state,this.logger.error("Invalid id_token received in the response"),r=T.a.createInvalidIdTokenError(d),this.cacheStorage.setItem(O.d.ERROR,r.errorCode),this.cacheStorage.setItem(O.d.ERROR_DESC,r.errorMessage))}}else{i=t.state,a=t.state;var R=this.cacheStorage.getItem(""+O.j.STATE_LOGIN+O.c.resourceDelimiter+t.state,this.inCookie);this.logger.error("State Mismatch.Expected State: "+R+",Actual State: "+t.state),r=T.a.createInvalidStateError(t.state,R),this.cacheStorage.setItem(O.d.ERROR,r.errorCode),this.cacheStorage.setItem(O.d.ERROR_DESC,r.errorMessage)}if(this.cacheStorage.removeItem(""+O.j.RENEW_STATUS+O.c.resourceDelimiter+t.state),this.cacheStorage.resetTempCacheItems(t.state),this.inCookie&&(this.cacheStorage.setItemCookie(i,"",-1),this.cacheStorage.clearMsalCookie(t.state)),r)throw r;if(!n)throw E.a.createUnexpectedError("Response is null");return n},t.prototype.populateAuthority=function(e,t,r,n){var o=u.a.generateAuthorityKey(e),i=r.getItem(o,t);return h.a.isEmpty(i)?i:m.a.replaceTenantPath(i,n.tenantId)},t.prototype.getAccount=function(){if(this.account)return this.account;var e=this.cacheStorage.getItem(O.f.IDTOKEN),t=this.cacheStorage.getItem(O.f.CLIENT_INFO);if(!h.a.isEmpty(e)&&!h.a.isEmpty(t)){var r=new s.a(e),n=new c.a(t);return this.account=l.a.createAccount(r,n),this.account}return null},t.prototype.getAccountState=function(e){if(e){var t=e.indexOf(O.c.resourceDelimiter);if(t>-1&&t+1<e.length)return e.substring(t+1)}return e},t.prototype.getAllAccounts=function(){for(var e=[],t=this.cacheStorage.getAllAccessTokens(O.c.clientId,O.c.homeAccountIdentifier),r=0;r<t.length;r++){var n=new s.a(t[r].value.idToken),o=new c.a(t[r].value.homeAccountIdentifier),i=l.a.createAccount(n,o);e.push(i)}return this.getUniqueAccounts(e)},t.prototype.getUniqueAccounts=function(e){if(!e||e.length<=1)return e;for(var t=[],r=[],n=0;n<e.length;++n)e[n].homeAccountIdentifier&&-1===t.indexOf(e[n].homeAccountIdentifier)&&(t.push(e[n].homeAccountIdentifier),r.push(e[n]));return r},t.prototype.broadcast=function(e,t){var r=new CustomEvent(e,{detail:t});window.dispatchEvent(r)},t.prototype.getCachedTokenInternal=function(e,t,r,n){var o=t||this.getAccount();if(!o)return null;var i=this.authorityInstance?this.authorityInstance:I.a.CreateInstance(this.authority,this.config.auth.validateAuthority),c=this.getTokenType(o,e,!0),s=new a.a(i,this.clientId,c,this.getRedirectUri(),e,r,n);return this.getCachedToken(s,t)},t.prototype.getScopesForEndpoint=function(e){if(this.config.framework.unprotectedResources.length>0)for(var t=0;t<this.config.framework.unprotectedResources.length;t++)if(e.indexOf(this.config.framework.unprotectedResources[t])>-1)return null;if(this.config.framework.protectedResourceMap.size>0)for(var r=0,n=Array.from(this.config.framework.protectedResourceMap.keys());r<n.length;r++){var o=n[r];if(e.indexOf(o)>-1)return this.config.framework.protectedResourceMap.get(o)}return e.indexOf("http://")>-1||e.indexOf("https://")>-1?m.a.getHostFromUri(e)===m.a.getHostFromUri(this.getRedirectUri())?new Array(this.clientId):null:new Array(this.clientId)},t.prototype.getLoginInProgress=function(){return this.cacheStorage.getItem(O.j.INTERACTION_STATUS)===O.c.inProgress},t.prototype.setInteractionInProgress=function(e){e?this.cacheStorage.setItem(O.j.INTERACTION_STATUS,O.c.inProgress):this.cacheStorage.removeItem(O.j.INTERACTION_STATUS)},t.prototype.setloginInProgress=function(e){this.setInteractionInProgress(e)},t.prototype.getAcquireTokenInProgress=function(){return this.cacheStorage.getItem(O.j.INTERACTION_STATUS)===O.c.inProgress},t.prototype.setAcquireTokenInProgress=function(e){this.setInteractionInProgress(e)},t.prototype.getLogger=function(){return this.logger},t.prototype.setLogger=function(e){this.logger=e},t.prototype.getRedirectUri=function(e){return e||("function"==typeof this.config.auth.redirectUri?this.config.auth.redirectUri():this.config.auth.redirectUri)},t.prototype.getPostLogoutRedirectUri=function(){return"function"==typeof this.config.auth.postLogoutRedirectUri?this.config.auth.postLogoutRedirectUri():this.config.auth.postLogoutRedirectUri},t.prototype.getCurrentConfiguration=function(){if(!this.config)throw w.a.createNoSetConfigurationError();return this.config},t.prototype.getTokenType=function(e,t,r){return r?l.a.compareAccounts(e,this.getAccount())?t.indexOf(this.config.auth.clientId)>-1?P:N:t.indexOf(this.config.auth.clientId)>-1?P:j:l.a.compareAccounts(e,this.getAccount())?t.indexOf(this.clientId)>-1?P:N:j},t.prototype.setAccountCache=function(e,t){var r=e?this.getAccountId(e):O.c.no_account,n=u.a.generateAcquireTokenAccountKey(r,t);this.cacheStorage.setItem(n,JSON.stringify(e))},t.prototype.setAuthorityCache=function(e,t){var r=u.a.generateAuthorityKey(e);this.cacheStorage.setItem(r,m.a.CanonicalizeUri(t),this.inCookie)},t.prototype.updateCacheEntries=function(e,t,r,n){n&&this.cacheStorage.setItem(""+O.j.LOGIN_REQUEST+O.c.resourceDelimiter+e.state,n,this.inCookie),r?this.cacheStorage.setItem(""+O.j.STATE_LOGIN+O.c.resourceDelimiter+e.state,e.state,this.inCookie):this.setAccountCache(t,e.state),this.setAuthorityCache(e.state,e.authority),this.cacheStorage.setItem(""+O.j.NONCE_IDTOKEN+O.c.resourceDelimiter+e.state,e.nonce,this.inCookie)},t.prototype.getAccountId=function(e){return h.a.isEmpty(e.homeAccountIdentifier)?O.c.no_account:e.homeAccountIdentifier},t.prototype.buildIDTokenRequest=function(e){return{scopes:[this.clientId],authority:this.authority,account:this.getAccount(),extraQueryParameters:e.extraQueryParameters,correlationId:e.correlationId}},t.prototype.getTelemetryManagerFromConfig=function(e,t){if(!e)return _.a.getTelemetrymanagerStub(t,this.logger);var r=e.applicationName,n=e.applicationVersion,o=e.telemetryEmitter;if(!r||!n||!o)throw w.a.createTelemetryConfigError(e);var i={platform:{applicationName:r,applicationVersion:n},clientId:t};return new _.a(i,o,this.logger)},t}()}).call(this,r(93).Promise)},440:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r(1),o=r(184),i=r(19),a={clientId:"",authority:null,validateAuthority:!0,authorityMetadata:"",knownAuthorities:[],redirectUri:function(){return i.a.getCurrentUrl()},postLogoutRedirectUri:function(){return i.a.getCurrentUrl()},navigateToLoginRequestUrl:!0},c={cacheLocation:"sessionStorage",storeAuthStateInCookie:!1},s={logger:new o.b(null),loadFrameTimeout:6e3,tokenRenewalOffsetSeconds:300,navigateFrameWait:500},u={isAngular:!1,unprotectedResources:new Array,protectedResourceMap:new Map};function l(e){var t=e.auth,r=e.cache,o=void 0===r?{}:r,i=e.system,l=void 0===i?{}:i,d=e.framework,h=void 0===d?{}:d;return{auth:n.a({},a,t),cache:n.a({},c,o),system:n.a({},s,l),framework:n.a({},u,h)}}},49:function(e,t,r){"use strict";r.d(t,"c",(function(){return n})),r.d(t,"b",(function(){return o})),r.d(t,"d",(function(){return i})),r.d(t,"a",(function(){return a})),r.d(t,"e",(function(){return c})),r.d(t,"f",(function(){return s}));var n="msal.",o="event_name",i="start_time",a="elapsed_time",c={MsalCorrelationIdConstStrKey:"Microsoft.MSAL.correlation_id",ApiTelemIdConstStrKey:"msal.api_telem_id",ApiIdConstStrKey:"msal.api_id",BrokerAppConstStrKey:"Microsoft_MSAL_broker_app",CacheEventCountConstStrKey:"Microsoft_MSAL_cache_event_count",HttpEventCountTelemetryBatchKey:"Microsoft_MSAL_http_event_count",IdpConstStrKey:"Microsoft_MSAL_idp",IsSilentTelemetryBatchKey:"",IsSuccessfulConstStrKey:"Microsoft_MSAL_is_successful",ResponseTimeConstStrKey:"Microsoft_MSAL_response_time",TenantIdConstStrKey:"Microsoft_MSAL_tenant_id",UiEventCountTelemetryBatchKey:"Microsoft_MSAL_ui_event_count"},s="<tenant>"},57:function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return a}));var n=r(16),o=r(19),i=r(2),a=function(){function t(){}return t.isInIframe=function(){return window.parent!==window},t.isInPopup=function(){return!(!window.opener||window.opener===window)},t.generateFrameName=function(e,t){return""+e+i.c.resourceDelimiter+t},t.monitorWindowForHash=function(r,i,a,c,s){return new e((function(e,u){var l=i/t.POLLING_INTERVAL_MS,d=0;c.verbose("monitorWindowForHash polling started");var h=setInterval((function(){if(r.closed)return c.error("monitorWindowForHash window closed"),clearInterval(h),void u(n.a.createUserCancelledError());var t;try{t=r.location.href}catch(e){}if(s)d++;else{if(!t||"about:blank"===t)return;d++}t&&o.a.urlContainsHash(t)?(c.verbose("monitorWindowForHash found url in hash"),clearInterval(h),e(r.location.hash)):d>l&&(c.error("monitorWindowForHash unable to find hash in url, timing out"),c.errorPii("monitorWindowForHash polling timed out for url: "+a),clearInterval(h),u(n.a.createTokenRenewalTimeoutError()))}),t.POLLING_INTERVAL_MS)}))},t.loadFrame=function(t,r,n,o){var i=this;return o.infoPii("LoadFrame: "+r),new e((function(e,a){setTimeout((function(){var n=i.loadFrameSync(t,r,o);n?e(n):a("Unable to load iframe with name: "+r)}),n)}))},t.loadFrameSync=function(e,r,n){var o=t.addHiddenIFrame(r,n);return o?(""!==o.src&&"about:blank"!==o.src||(o.src=e,n.infoPii("Frame Name : "+r+" Navigated to: "+e)),o):null},t.addHiddenIFrame=function(e,t){if(void 0===e)return null;t.infoPii("Add msal frame to document:"+e);var r=document.getElementById(e);if(!r){if(document.createElement&&document.documentElement&&-1===window.navigator.userAgent.indexOf("MSIE 5.0")){var n=document.createElement("iframe");n.setAttribute("id",e),n.setAttribute("aria-hidden","true"),n.style.visibility="hidden",n.style.position="absolute",n.style.width=n.style.height="0",n.style.border="0",n.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),r=document.getElementsByTagName("body")[0].appendChild(n)}else document.body&&document.body.insertAdjacentHTML&&document.body.insertAdjacentHTML("beforeend","<iframe name='"+e+"' id='"+e+"' style='display:none'></iframe>");window.frames&&window.frames[e]&&(r=window.frames[e])}return r},t.removeHiddenIframe=function(e){document.body===e.parentNode&&document.body.removeChild(e)},t.getIframeWithHash=function(e){var t=document.getElementsByTagName("iframe");return Array.apply(null,Array(t.length)).map((function(e,r){return t.item(r)})).filter((function(t){try{return t.contentWindow.location.hash===e}catch(e){return!1}}))[0]},t.getPopups=function(){return window.openedWindows||(window.openedWindows=[]),window.openedWindows},t.getPopUpWithHash=function(e){return t.getPopups().filter((function(t){try{return t.location.hash===e}catch(e){return!1}}))[0]},t.trackPopup=function(e){t.getPopups().push(e)},t.closePopups=function(){t.getPopups().forEach((function(e){return e.close()}))},t.blockReloadInHiddenIframes=function(){if(o.a.urlContainsHash(window.location.hash)&&t.isInIframe())throw n.a.createBlockTokenRequestsInHiddenIframeError()},t.checkIfBackButtonIsPressed=function(e){var t=e.getItem(i.j.REDIRECT_REQUEST);if(t&&!o.a.urlContainsHash(window.location.hash)){var r=t.split(i.c.resourceDelimiter),n=r.length>1?r[r.length-1]:null;e.resetTempCacheItems(n)}},t.POLLING_INTERVAL_MS=50,t}()}).call(this,r(93).Promise)},70:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(1),o={code:"unexpected_error",desc:"Unexpected error in authentication."},i={code:"no_window_object",desc:"No window object available. Details:"},a=function(e){function t(r,n){var o=e.call(this,n)||this;return Object.setPrototypeOf(o,t.prototype),o.errorCode=r,o.errorMessage=n,o.name="AuthError",o}return n.d(t,e),t.createUnexpectedError=function(e){return new t(o.code,o.desc+": "+e)},t.createNoWindowObjectError=function(e){return new t(i.code,i.desc+" "+e)},t}(Error)},71:function(e,t,r){"use strict";r.d(t,"b",(function(){return n})),r.d(t,"a",(function(){return u}));var n,o=r(1),i=r(27),a=r(282),c=r(19),s=r(283);!function(e){e[e.Aad=0]="Aad",e[e.Adfs=1]="Adfs",e[e.B2C=2]="B2C"}(n||(n={}));var u=function(){function e(e,t,r){this.IsValidationEnabled=t,this.CanonicalAuthority=e,this.validateAsUri(),this.tenantDiscoveryResponse=r}return Object.defineProperty(e.prototype,"Tenant",{get:function(){return this.CanonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"AuthorizationEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.AuthorizationEndpoint.replace(/{tenant}|{tenantid}/g,this.Tenant)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"EndSessionEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.EndSessionEndpoint.replace(/{tenant}|{tenantid}/g,this.Tenant)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"SelfSignedJwtAudience",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.Issuer.replace(/{tenant}|{tenantid}/g,this.Tenant)},enumerable:!0,configurable:!0}),e.prototype.validateResolved=function(){if(!this.hasCachedMetadata())throw"Please call ResolveEndpointsAsync first"},Object.defineProperty(e.prototype,"CanonicalAuthority",{get:function(){return this.canonicalAuthority},set:function(e){this.canonicalAuthority=c.a.CanonicalizeUri(e),this.canonicalAuthorityUrlComponents=null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CanonicalAuthorityUrlComponents",{get:function(){return this.canonicalAuthorityUrlComponents||(this.canonicalAuthorityUrlComponents=c.a.GetUrlComponents(this.CanonicalAuthority)),this.canonicalAuthorityUrlComponents},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"DefaultOpenIdConfigurationEndpoint",{get:function(){return this.CanonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:!0,configurable:!0}),e.prototype.validateAsUri=function(){var e;try{e=this.CanonicalAuthorityUrlComponents}catch(e){throw i.b.invalidAuthorityType}if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw i.b.authorityUriInsecure;if(!e.PathSegments||e.PathSegments.length<1)throw i.b.authorityUriInvalidPath},e.prototype.DiscoverEndpoints=function(e,t,r){var n=new a.a,o=new s.a(r,"openIdConfigurationEndpoint");return o.url=e,o.httpMethod="GET",t.startEvent(o),n.sendRequestAsync(e,"GET",!0).then((function(e){return o.httpResponseStatus=e.statusCode,t.stopEvent(o),{AuthorizationEndpoint:e.body.authorization_endpoint,EndSessionEndpoint:e.body.end_session_endpoint,Issuer:e.body.issuer}})).catch((function(e){throw o.serverErrorCode=e,t.stopEvent(o),e}))},e.prototype.resolveEndpointsAsync=function(e,t){return o.b(this,void 0,void 0,(function(){var r,n;return o.e(this,(function(o){switch(o.label){case 0:return[4,this.GetOpenIdConfigurationEndpointAsync(e,t)];case 1:return r=o.sent(),n=this,[4,this.DiscoverEndpoints(r,e,t)];case 2:return n.tenantDiscoveryResponse=o.sent(),[2,this.tenantDiscoveryResponse]}}))}))},e.prototype.hasCachedMetadata=function(){return!!(this.tenantDiscoveryResponse&&this.tenantDiscoveryResponse.AuthorizationEndpoint&&this.tenantDiscoveryResponse.EndSessionEndpoint&&this.tenantDiscoveryResponse.Issuer)},e}()},829:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(830);Office.initialize=function(){Office.context.ui.messageParent&&(i.handleRedirectCallback(a),"yes"===localStorage.getItem("loggedIn")?i.acquireTokenRedirect(o):i.loginRedirect(o))};var o={scopes:["https://graph.microsoft.com/User.Read"]},i=new n.UserAgentApplication({auth:{clientId:"63483ce1-539b-42c9-a984-fa7f327c1724",authority:"https://login.microsoftonline.com/common",redirectUri:"https://localhost:3000/fallbackauthdialog.html",navigateToLoginRequestUrl:!1},cache:{cacheLocation:"localStorage",storeAuthStateInCookie:!0}});function a(e,t){e?(console.log(e),Office.context.ui.messageParent(JSON.stringify({status:"failure",result:e}))):"id_token"===t.tokenType?(console.log(t.idToken.rawIdToken),localStorage.setItem("loggedIn","yes")):(console.log("token type is:"+t.tokenType),Office.context.ui.messageParent(JSON.stringify({status:"success",result:t.accessToken})))}},830:function(e,t,r){"use strict";r.r(t);var n=r(406);r.d(t,"UserAgentApplication",(function(){return n.a}));var o=r(184);r.d(t,"Logger",(function(){return o.b})),r.d(t,"LogLevel",(function(){return o.a}));var i=r(109);r.d(t,"Account",(function(){return i.a}));var a=r(2);r.d(t,"Constants",(function(){return a.c})),r.d(t,"ServerHashParamKeys",(function(){return a.i}));var c=r(71);r.d(t,"Authority",(function(){return c.a}));var s=r(33);r.d(t,"CryptoUtils",(function(){return s.a}));var u=r(19);r.d(t,"UrlUtils",(function(){return u.a}));var l=r(57);r.d(t,"WindowUtils",(function(){return l.a}));var d=r(70);r.d(t,"AuthError",(function(){return d.a}));var h=r(16);r.d(t,"ClientAuthError",(function(){return h.a}));var p=r(185);r.d(t,"ServerError",(function(){return p.a}));var f=r(27);r.d(t,"ClientConfigurationError",(function(){return f.a}));var g=r(187);r.d(t,"InteractionRequiredAuthError",(function(){return g.a}))},85:function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var n=r(1),o=r(71),i=r(282),a=r(2),c=function(e){function t(t,r,n){return e.call(this,t,r,n)||this}return n.d(t,e),Object.defineProperty(t.prototype,"AadInstanceDiscoveryEndpointUrl",{get:function(){return t.AadInstanceDiscoveryEndpoint+"?api-version=1.0&authorization_endpoint="+this.CanonicalAuthority+"oauth2/v2.0/authorize"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"AuthorityType",{get:function(){return o.b.Aad},enumerable:!0,configurable:!0}),t.prototype.GetOpenIdConfigurationEndpointAsync=function(e,t){return n.b(this,void 0,void 0,(function(){var r,o;return n.e(this,(function(n){return!this.IsValidationEnabled||this.IsInTrustedHostList(this.CanonicalAuthorityUrlComponents.HostNameAndPort)?[2,this.DefaultOpenIdConfigurationEndpoint]:(r=new i.a,"GET",o=e.createAndStartHttpEvent(t,"GET",this.AadInstanceDiscoveryEndpointUrl,"AadInstanceDiscoveryEndpoint"),[2,r.sendRequestAsync(this.AadInstanceDiscoveryEndpointUrl,"GET",!0).then((function(t){return o.httpResponseStatus=t.statusCode,e.stopEvent(o),t.body.tenant_discovery_endpoint})).catch((function(t){throw o.serverErrorCode=t,e.stopEvent(o),t}))])}))}))},t.prototype.IsInTrustedHostList=function(e){return a.a[e.toLowerCase()]},t.AadInstanceDiscoveryEndpoint="https://login.microsoftonline.com/common/discovery/instance",t}(o.a),s=r(27),u={},l=function(e){function t(t,r,n){return e.call(this,t,r,n)||this}return n.d(t,e),Object.defineProperty(t.prototype,"AuthorityType",{get:function(){return o.b.B2C},enumerable:!0,configurable:!0}),t.prototype.GetOpenIdConfigurationEndpointAsync=function(e,t){return n.b(this,void 0,void 0,(function(){return n.e(this,(function(e){if(!this.IsValidationEnabled||this.IsInTrustedHostList(this.CanonicalAuthorityUrlComponents.HostNameAndPort))return[2,this.DefaultOpenIdConfigurationEndpoint];throw s.a.createUntrustedAuthorityError()}))}))},t.prototype.IsInTrustedHostList=function(e){if(this.IsValidationEnabled&&!Object.keys(u).length)throw s.a.createKnownAuthoritiesNotSetError();return u[e.toLowerCase()]},t.B2C_PREFIX="tfp",t}(o.a),d=r(22),h=r(19),p=function(){function e(){}return e.setKnownAuthorities=function(e,t){e&&!Object.keys(u).length&&t.forEach((function(e){u[e]=e}))},e.saveMetadataFromNetwork=function(e,t,r){return n.b(this,void 0,void 0,(function(){var o;return n.e(this,(function(n){switch(n.label){case 0:return[4,e.resolveEndpointsAsync(t,r)];case 1:return o=n.sent(),this.metadataMap.set(e.CanonicalAuthority,o),[2,o]}}))}))},e.getMetadata=function(e){return this.metadataMap.get(e)},e.saveMetadataFromConfig=function(e,t){try{if(t){var r=JSON.parse(t);if(!r.authorization_endpoint||!r.end_session_endpoint||!r.issuer)throw s.a.createInvalidAuthorityMetadataError();this.metadataMap.set(e,{AuthorizationEndpoint:r.authorization_endpoint,EndSessionEndpoint:r.end_session_endpoint,Issuer:r.issuer})}}catch(e){throw s.a.createInvalidAuthorityMetadataError()}},e.detectAuthorityFromUrl=function(e){return e=h.a.CanonicalizeUri(e),"adfs"===h.a.GetUrlComponents(e).PathSegments[0]?o.b.Adfs:Object.keys(u).length?o.b.B2C:o.b.Aad},e.CreateInstance=function(t,r,n){if(d.a.isEmpty(t))return null;switch(n&&this.saveMetadataFromConfig(t,n),e.detectAuthorityFromUrl(t)){case o.b.B2C:return new l(t,r,this.getMetadata(t));case o.b.Aad:return new c(t,r,this.getMetadata(t));default:throw s.a.createInvalidAuthorityTypeError()}},e.metadataMap=new Map,e}()},86:function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},93:function(e,t,r){(function(t,r){
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */var n;n=function(){"use strict";function e(e){return"function"==typeof e}var n=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},o=0,i=void 0,a=void 0,c=function(e,t){f[o]=e,f[o+1]=t,2===(o+=2)&&(a?a(g):b())},s="undefined"!=typeof window?window:void 0,u=s||{},l=u.MutationObserver||u.WebKitMutationObserver,d="undefined"==typeof self&&void 0!==t&&"[object process]"==={}.toString.call(t),h="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function p(){var e=setTimeout;return function(){return e(g,1)}}var f=new Array(1e3);function g(){for(var e=0;e<o;e+=2)(0,f[e])(f[e+1]),f[e]=void 0,f[e+1]=void 0;o=0}var m,y,v,I,b=void 0;function w(e,t){var r=this,n=new this.constructor(S);void 0===n[T]&&U(n);var o=r._state;if(o){var i=arguments[o-1];c((function(){return N(o,n,i,r._result)}))}else R(r,n,e,t);return n}function E(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(S);return A(t,e),t}d?b=function(){return t.nextTick(g)}:l?(y=0,v=new l(g),I=document.createTextNode(""),v.observe(I,{characterData:!0}),b=function(){I.data=y=++y%2}):h?((m=new MessageChannel).port1.onmessage=g,b=function(){return m.port2.postMessage(0)}):b=void 0===s?function(){try{var e=Function("return this")().require("vertx");return void 0!==(i=e.runOnLoop||e.runOnContext)?function(){i(g)}:p()}catch(e){return p()}}():p();var T=Math.random().toString(36).substring(2);function S(){}function C(t,r,n){r.constructor===t.constructor&&n===w&&r.constructor.resolve===E?function(e,t){1===t._state?k(e,t._result):2===t._state?O(e,t._result):R(t,void 0,(function(t){return A(e,t)}),(function(t){return O(e,t)}))}(t,r):void 0===n?k(t,r):e(n)?function(e,t,r){c((function(e){var n=!1,o=function(e,t,r,n){try{e.call(t,r,n)}catch(e){return e}}(r,t,(function(r){n||(n=!0,t!==r?A(e,r):k(e,r))}),(function(t){n||(n=!0,O(e,t))}),e._label);!n&&o&&(n=!0,O(e,o))}),e)}(t,r,n):k(t,r)}function A(e,t){if(e===t)O(e,new TypeError("You cannot resolve a promise with itself"));else if(o=typeof(n=t),null===n||"object"!==o&&"function"!==o)k(e,t);else{var r=void 0;try{r=t.then}catch(t){return void O(e,t)}C(e,t,r)}var n,o}function _(e){e._onerror&&e._onerror(e._result),P(e)}function k(e,t){void 0===e._state&&(e._result=t,e._state=1,0!==e._subscribers.length&&c(P,e))}function O(e,t){void 0===e._state&&(e._state=2,e._result=t,c(_,e))}function R(e,t,r,n){var o=e._subscribers,i=o.length;e._onerror=null,o[i]=t,o[i+1]=r,o[i+2]=n,0===i&&e._state&&c(P,e)}function P(e){var t=e._subscribers,r=e._state;if(0!==t.length){for(var n=void 0,o=void 0,i=e._result,a=0;a<t.length;a+=3)n=t[a],o=t[a+r],n?N(r,n,o,i):o(i);e._subscribers.length=0}}function N(t,r,n,o){var i=e(n),a=void 0,c=void 0,s=!0;if(i){try{a=n(o)}catch(e){s=!1,c=e}if(r===a)return void O(r,new TypeError("A promises callback cannot return that same promise."))}else a=o;void 0!==r._state||(i&&s?A(r,a):!1===s?O(r,c):1===t?k(r,a):2===t&&O(r,a))}var j=0;function U(e){e[T]=j++,e._state=void 0,e._result=void 0,e._subscribers=[]}var x=function(){function e(e,t){this._instanceConstructor=e,this.promise=new e(S),this.promise[T]||U(this.promise),n(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?k(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&k(this.promise,this._result))):O(this.promise,new Error("Array Methods must be provided an Array"))}return e.prototype._enumerate=function(e){for(var t=0;void 0===this._state&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var r=this._instanceConstructor,n=r.resolve;if(n===E){var o=void 0,i=void 0,a=!1;try{o=e.then}catch(e){a=!0,i=e}if(o===w&&void 0!==e._state)this._settledAt(e._state,t,e._result);else if("function"!=typeof o)this._remaining--,this._result[t]=e;else if(r===L){var c=new r(S);a?O(c,i):C(c,e,o),this._willSettleAt(c,t)}else this._willSettleAt(new r((function(t){return t(e)})),t)}else this._willSettleAt(n(e),t)},e.prototype._settledAt=function(e,t,r){var n=this.promise;void 0===n._state&&(this._remaining--,2===e?O(n,r):this._result[t]=r),0===this._remaining&&k(n,this._result)},e.prototype._willSettleAt=function(e,t){var r=this;R(e,void 0,(function(e){return r._settledAt(1,t,e)}),(function(e){return r._settledAt(2,t,e)}))},e}(),L=function(){function t(e){this[T]=j++,this._result=this._state=void 0,this._subscribers=[],S!==e&&("function"!=typeof e&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof t?function(e,t){try{t((function(t){A(e,t)}),(function(t){O(e,t)}))}catch(t){O(e,t)}}(this,e):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return t.prototype.catch=function(e){return this.then(null,e)},t.prototype.finally=function(t){var r=this.constructor;return e(t)?this.then((function(e){return r.resolve(t()).then((function(){return e}))}),(function(e){return r.resolve(t()).then((function(){throw e}))})):this.then(t,t)},t}();return L.prototype.then=w,L.all=function(e){return new x(this,e).promise},L.race=function(e){var t=this;return n(e)?new t((function(r,n){for(var o=e.length,i=0;i<o;i++)t.resolve(e[i]).then(r,n)})):new t((function(e,t){return t(new TypeError("You must pass an array to race."))}))},L.resolve=E,L.reject=function(e){var t=new this(S);return O(t,e),t},L._setScheduler=function(e){a=e},L._setAsap=function(e){c=e},L._asap=c,L.polyfill=function(){var e=void 0;if(void 0!==r)e=r;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var n=null;try{n=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===n&&!t.cast)return}e.Promise=L},L.Promise=L,L},e.exports=n()}).call(this,r(157),r(86))},98:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(27),o=r(2),i=function(){function e(){}return e.isIntersectingScopes=function(e,t){for(var r=this.trimAndConvertArrayToLowerCase(e.slice()),n=this.trimAndConvertArrayToLowerCase(t.slice()),o=0;o<n.length;o++)if(r.indexOf(n[o].toLowerCase())>-1)return!0;return!1},e.containsScope=function(e,t){var r=this.trimAndConvertArrayToLowerCase(e.slice());return this.trimAndConvertArrayToLowerCase(t.slice()).every((function(e){return r.indexOf(e.toString().toLowerCase())>=0}))},e.trimAndConvertToLowerCase=function(e){return e.trim().toLowerCase()},e.trimAndConvertArrayToLowerCase=function(e){var t=this;return e.map((function(e){return t.trimAndConvertToLowerCase(e)}))},e.removeElement=function(e,t){var r=this.trimAndConvertToLowerCase(t);return e.filter((function(e){return e!==r}))},e.parseScope=function(e){var t="";if(e)for(var r=0;r<e.length;++r)t+=r!==e.length-1?e[r]+" ":e[r];return t},e.validateInputScope=function(e,t,r){if(e){if(!Array.isArray(e))throw n.a.createScopesNonArrayError(e);if(e.length<1)throw n.a.createEmptyScopesArrayError(e.toString());if(e.indexOf(r)>-1&&e.length>1)throw n.a.createClientIdSingleScopeError(e.toString())}else if(t)throw n.a.createScopesRequiredError(e)},e.getScopeFromState=function(e){if(e){var t=e.indexOf(o.c.resourceDelimiter);if(t>-1&&t+1<e.length)return e.substring(t+1)}return""},e.appendScopes=function(e,t){if(e){var r=t?this.trimAndConvertArrayToLowerCase(t.slice()):null,n=this.trimAndConvertArrayToLowerCase(e.slice());return r?n.concat(r):n}return null},e}()}});
//# sourceMappingURL=fallbackauthdialog.js.map